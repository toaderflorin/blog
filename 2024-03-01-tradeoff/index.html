<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><style data-href="/styles.a143479275fa8033557c.css" data-identity="gatsby-global-css">@font-face{font-family:gilroy;font-weight:400;src:url(/fonts/Gilroy-Regular.ttf)}@font-face{font-family:instrument;src:url(/fonts/Instrument.ttf)}@font-face{font-family:matter;src:url(/fonts/Matter-Regular.ttf)}@font-face{font-family:neuehaas;src:url(/fonts/NeueHaasDisplayRoman.ttf)}@font-face{font-family:lato;src:url(/fonts/Lato-Regular.ttf)}@font-face{font-family:avenir;src:url(/fonts/AvenirLTStd-Roman.otf)}@font-face{font-family:walsheim;src:url(/fonts/GT-Walsheim.otf)}@font-face{font-family:cisco;src:url(/fonts/CiscoSans.ttf)}@font-face{font-family:nexa;src:url(/fonts/Nexa-Book.ttf)}@font-face{font-family:tt;src:url(/fonts/TTHoves-Regular.ttf)}@font-face{font-family:poly;src:url(/fonts/poly.otf)}@font-face{font-family:suisse;src:url(/fonts/SuisseIntl-Regular.ttf)}@font-face{font-family:aktiv;src:url(/fonts/AktivGrotesk-Light.ttf)}@font-face{font-family:Matter;src:url(/fonts/Matter-Light.ttf)}@font-face{font-family:balto;src:url(/fonts/Balto-Book.ttf)}@font-face{font-family:mona;src:url(/fonts/MonaSans-Regular.ttf)}@font-face{font-family:roobert;src:url(/fonts/Roobert-Regular.ttf)}@font-face{font-family:balto;font-weight:700;src:url(/fonts/Balto-Bold.woff2)}@font-face{font-family:now;src:url(/fonts/HelveticaNow.otf)}@font-face{font-family:now;font-weight:700;src:url(/fonts/helvetica-bold.ttf)}@font-face{font-family:satoshi;font-weight:700;src:url(/fonts/Satoshi-Regular.otf)}@font-face{font-family:passenger;font-weight:700;src:url(/fonts/Passenger.otf)}@font-face{font-family:dmsans;src:url(/fonts/DMSans.ttf)}@font-face{font-family:montreal;src:url(/fonts/ppneuemontreal-book.otf)}:root{--color-primary:#ff164c}*,:after,:before{box-sizing:border-box;margin:0}h1,h2,h3{font-weight:400;margin:0}body,html{margin:0;overscroll-behavior-y:none;padding:0}pre.shiki{border-radius:5px;padding:15px}code,pre.shiki{font-size:13px}body{color:#000;font-family:now,serif;font-size:15px;line-height:1.45}h1{font-size:1.8rem}h3{font-size:1.3rem;line-height:2;margin-bottom:-1rem}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{margin:.7rem 0}a{color:var(--color-primary);text-decoration:none}.img{width:100%}.img-side{float:left;width:300px}ol,ul{margin:.7rem 0}.article-icon{float:left;height:64px;margin-right:8px;margin-top:6px;width:64px}.shiki{overflow:clip}@keyframes zoom{to{opacity:0}}@keyframes opIn{to{opacity:100%}}@keyframes opacity{to{opacity:.5}}@keyframes blur{to{scale:1.3 1.3}}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.left-0{left:0}.right-0{right:0}.top-0{top:0}.z-0{z-index:0}.mx-auto{margin-left:auto;margin-right:auto}.my-5{margin-top:1.25rem}.mb-5,.my-5{margin-bottom:1.25rem}.mt-3{margin-top:.75rem}.mt-\[10px\]{margin-top:10px}.flex{display:flex}.hidden{display:none}.h-\[215px\]{height:215px}.h-\[3px\]{height:3px}.h-\[82px\]{height:82px}.w-\[100\%\]{width:100%}.w-\[24px\]{width:24px}.w-\[5px\]{width:5px}.w-\[700px\]{width:700px}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.gap-1{gap:.25rem}.gap-3{gap:.75rem}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.bg-\[color\:var\(--color-primary\)\]{background-color:var(--color-primary)}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.p-5{padding:1.25rem}.pb-\[20px\]{padding-bottom:20px}.pt-10{padding-top:2.5rem}.pt-4{padding-top:1rem}.text-center{text-align:center}.text-right{text-align:right}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-\[color\:var\(--color-primary\)\]{color:var(--color-primary)}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-slate-100{--tw-text-opacity:1;color:rgb(241 245 249/var(--tw-text-opacity))}.text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 0\.3\)\]{--tw-shadow:0 5px 30px -15px rgba(0,0,0,.3);--tw-shadow-colored:0 5px 30px -15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 1\)\]{--tw-shadow:0 5px 30px -15px #000;--tw-shadow-colored:0 5px 30px -15px var(--tw-shadow-color)}.shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 1\)\],.shadow-lg{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.duration-300{transition-duration:.3s}@keyframes abc{0%{opacity:0}to{opacity:1}}.headx{animation:abc 1s linear;animation-duration:1s;animation-fill-mode:forwards}.hero-background{background:url(/img/p1.webp);background:red;background-position:50%;background-size:cover;height:550px;position:fixed;top:0;z-index:500}.hover\:text-black:hover{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.hover\:shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 0\.7\)\]:hover{--tw-shadow:0 5px 30px -15px rgba(0,0,0,.7);--tw-shadow-colored:0 5px 30px -15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.span-1{grid-column:auto/span 1}.span-2{grid-column:auto/span 2}.span-3{grid-column:auto/span 3}@media only screen and (max-width:600px){.span-1,.span-2,.span-3{grid-column:auto/span 1}}.cards{display:grid;gap:20px;grid-template-columns:1fr 1fr 1fr}.container{width:1000px}.margin{margin-top:550px}@media only screen and (max-width:600px){.cards{grid-template-columns:1fr;padding:10px;width:auto}.container{margin-left:15px;margin-right:15px;width:auto}.margin{margin-top:300px}}.inner{-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);background-image:url(/img/me.jpeg);background-size:contain;border-radius:50%;color:#fff;height:120px;margin-bottom:10px;width:120px}.bar{align-items:center;background:hsla(0,0%,78%,.04);bottom:0;display:flex;flex-direction:column;left:0;padding:20px;position:absolute;top:0;width:64px;z-index:100}.hero{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);background:radial-gradient(at top left,rgba(47,49,58,.97),rgba(26,27,35,.97));border-radius:7px;height:550px;margin-top:30px;overflow:clip;resize:both;width:1000px;@media only screen and (max-width:600px){height:300px;margin-left:15px;margin-right:15px;margin-top:15px;width:auto}}@media only screen and (max-width:600px){.header{padding-left:15px;width:auto}.post-container{padding:15px;width:auto}}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400&amp;display=swap"/><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=4376dbdae9096a24eda7625764953946" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4376dbdae9096a24eda7625764953946"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><header class="global-header"></header><main><div class="sticky top-0 left-0 right-0 text-white  h-[82px] shadow-lg mb-5" style="background:radial-gradient(at top center, rgba(47, 49, 58, 0.94), rgba(26, 27, 35, 0.94));font-size:16px"><div class="w-[700px] mx-auto flex items-center h-[82px] header"><img src="/img/me.jpeg" style="width:40px;border-radius:50%;margin-right:5px"/><a href="/" class="text-white">Florin Toader</a></div></div><title>Understanding Time Versus Space Tradeoffs</title><meta name="og:image:secure_url" content="https://florintoader.me/2024-01-08-ddd-bdd/cucumber.jpg"/><meta name="og:description" content="Here&#x27;s something that might be a bit controversial: I believe that for most software projects, the performance of the language (C#, Golang) doesn&#x27;t matter that much. The reason I am writing this article is that I&#x27;ve seen an almost cultlike obsession with various languages and tech stacks, to the point where teams are pushing for a complete rewrite of the application. I believe this is  not warranted for most projects. "/><div class="h-[50px] bg-red-400"></div><article class="w-[700px] mx-auto pt-[10px] mb-[20px] mt-[150px] post-container" itemscope=""><header><h1 itemProp="headline">Understanding Time Versus Space Tradeoffs</h1><p><i>March 06, 2024</i></p></header><section itemProp="articleBody"><p>As developers, we use hash tables on a daily basis (directly or indirectly) because they are ubiquitous in software. Yet if you ask most developers, they would not be able to explain how they work, so why not provide a simple explanation here?</p>
<p>Let’s assume you have a list of users, and you want to show the details for a user based on username. Since lists are usually implemented as linked lists under the hood, finding the element means iterating through the whole list, which is an O(n) operation. This is different from
accessing an array, which can be done by index. This is an O(1) operation. So what if we wanted to have something similar? We would need to store the usernames in an array under the hood, and somehow “convert” the username string to an index.</p>
<pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #C792EA">function</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">stringToNormalizedNumber</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">str</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">string</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #89DDFF">  </span><span style="color: #676E95; font-style: italic">// calculate the sum of character codes</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">charCodeSum</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">str</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #F07178">(</span><span style="color: #89DDFF">&#39;&#39;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">reduce</span><span style="color: #F07178">(</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">sum</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">char</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">sum</span><span style="color: #F07178"> </span><span style="color: #89DDFF">+</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">char</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">charCodeAt</span><span style="color: #F07178">(</span><span style="color: #F78C6C">0</span><span style="color: #F07178">)</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #F78C6C">0</span><span style="color: #F07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">  </span><span style="color: #676E95; font-style: italic">// combine string length and character code sum</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">str</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">length</span><span style="color: #F07178"> </span><span style="color: #89DDFF">+</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">charCodeSum</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">  </span><span style="color: #676E95; font-style: italic">// normalize to the range of 0 to 1, assuming 32-bit character codes</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #C792EA">const</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">normalizedRange</span><span style="color: #F07178"> </span><span style="color: #89DDFF">=</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">/</span><span style="color: #F07178"> </span><span style="color: #A6ACCD">Math</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">pow</span><span style="color: #F07178">(</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #F78C6C">32</span><span style="color: #F07178">)</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
<p>We can come up with a checksum function, for example. This isn’t a great way to do it, but it will do, as an example.</p>
<p>So what we do is we calculate the index based on the string. You will notice that:</p>
<ol>
<li>There will be a lot of empty space in the array.</li>
<li>There can be collisions, meaning that two different strings can have the same numeric index.</li>
</ol>
<p>So what we do is instead of just storing a user at each point in an array, we can store a list of users with the same checksum (called a bucket). So when we access an element, we actually iterate through the list and check against the username. Normally you shouldn’t have more than a few items in the list anyway. The bigger the array used, the smaller the chance of a collision, but obviously the more memory will be needed.</p>
<img src="hash.png" class="img" loading="lazy" />
<p><em>In ideal circumstances, the size of the array would be infinite, and access time would be O(1), but that’s not realistic. What we have is a tradeoff between access time and space.</em></p>
<h3>Caching / Materialized Views</h3>
<p>The simplest example of space versus execution time tradeoff that you’ll routinely encounter is caching. While a “dumb” cache can be easy to implement, <em>cache invalidation</em> is by no means a simple problem, so a common issue is out-of-date data.</p>
<p>An alternative to caching are materialized views, which is also a tradeoff. Imagine you have a complex query that is computationally expensive, and an application that is read heavy (say 100:1 read to write ratio). An interesting thing about materialized queries is they denormalize the data, which also means data duplication in itself. Let’s consider a very simple example, we have users and each user can define a set of addresses to which they can make orders online, in an online store.</p>
<img src="schema.png" class="img" loading="lazy" />
<p>A cross join between them results in data duplication.</p>
<pre class="shiki-unknown"><code>|ORDER              |asdas     |asdasd              |   
|asdasda sd         |asdasd    |                    | </code></pre>
<h3>Sharded Databases Also Require Data Duplication</h3>
<p>Sharding spreads your database <em>horizontally</em> over a number of nodes, along some <em>dimension</em>. In the above case, we could spread requests to nodes by user id. A very simple strategy would be to say that first node handles requests for user id in range [1, 1000], the second in range from [1001, 2000] and so on. Of course, some users can have more orders than others, etc. which leads to <em>hotspots</em>, so using an equal number of users per node isn’t the optimal strategy.</p>
<p>A slightly more advanced technique (like what Azure uses) is to use a shard map manager, but this is beyond the point of this article.</p>
<img src="azure.png" class="img" loading="lazy" />
<p>With sharding, you have two types of tables:</p>
<ul>
<li>Sharded tables</li>
<li>Replicated tables</li>
</ul>
<p>Also, each node has the same schema, and FK constraints are kept intact. So <code>User</code>, <code>UserAddress</code> and <code>UserOrder</code> will be sharded , while the <em>SupportedCountries</em> will be replicated. Again, this is a form of data duplication, and it’s a price we play</p>
<h3>Clustered Indexes Are A Form Of Materialized Views</h3>
<p>A common approach to fix read performance issues is to add.</p></section></article><div id="scroller" class="fixed h-[3px] left-0 top-0 bg-[color:var(--color-primary)]"></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2024-03-01-tradeoff/";window.___webpackCompilationHash="6571ff6ef062454ce882";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-30f2bf2a1846f97f91ab.js"],"app":["/app-4dd56cb766cf2c35fd40.js"],"component---src-pages-404-js":["/component---src-pages-404-js-8450d0b5021920db5d71.js"],"component---src-pages-index-js":["/component---src-pages-index-js-db6940863929983b7fd6.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-26890ade02ac40ec90e1.js"]};/*]]>*/</script><script src="/polyfill-30f2bf2a1846f97f91ab.js" nomodule=""></script><script src="/app-4dd56cb766cf2c35fd40.js" async=""></script><script src="/framework-d9aa49d9654a57a5d41b.js" async=""></script><script src="/webpack-runtime-01335b8f5fd7f8de01d6.js" async=""></script></body></html>