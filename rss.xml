<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Gatsby Starter Blog RSS Feed]]></title><description><![CDATA[A starter blog demonstrating what Gatsby can do.]]></description><link>https://florintoader.me</link><generator>GatsbyJS</generator><lastBuildDate>Wed, 13 Mar 2024 16:30:05 GMT</lastBuildDate><item><title><![CDATA[Service Data Ownership Is Hard]]></title><description><![CDATA[When building a monolith, it’s common to not think much about which service accesses which tables, especially when dealing with complex…]]></description><link>https://florintoader.me/2024-03-13-data-ownership/</link><guid isPermaLink="false">https://florintoader.me/2024-03-13-data-ownership/</guid><pubDate>Tue, 19 Mar 2024 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;When building a monolith, it’s common to not think much about which service accesses which tables, especially when dealing with complex business logic that needs to conditionally update data based on values of existing data, or if complex data aggregation is needed. To make matters worse, in many projects, not a lot of thought is given to how the database is structured, and it might not actually align well with the business domain (especially if DDD techniques are not followed). Which means it’s very easy to end up with a structure like this:&lt;/p&gt;
&lt;p&gt;What happens in a lot of projects is that your services are trying to create this sort of materialized view by pulling and aggregating data, which means they are coupled indirectly.&lt;/p&gt;
&lt;p&gt;We can clearly see that this breaks encapsulation. We would also want to reach a situation where each service owns its own data, so something like this.&lt;/p&gt;
&lt;p&gt;Keep in mind that the state of the whole application doesn’t have to obey ACID.&lt;/p&gt;
&lt;h3&gt;The Goal Is BASE Not ACID&lt;/h3&gt;
&lt;p&gt;My preferred way of splitting microservices is domain boundary lines. And if you find it hard to split the database schema, then that’s probably an indication that you might not want to split that part of the monolith.&lt;/p&gt;
&lt;p&gt;The goal around consistency is BASe.&lt;/p&gt;
&lt;p&gt;Most developers will be familiar with ACID constraints of a RDBMS.&lt;/p&gt;
&lt;p&gt;ACID is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Atomicity&lt;/strong&gt; ensures that a transaction is treated as a single unit of work. Either all the operations within the transaction are successfully completed, or none of them are. In other words, a transaction cannot be partially completed; it must be executed in its entirety or not at all. If any part of the transaction fails, the entire transaction is rolled back.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Consistency&lt;/strong&gt; ensures that the database remains in a consistent state before and after the transaction. This means that transactions must preserve the integrity constraints, data validation rules, and relationships defined in the database schema. For example, if a transaction violates a unique key constraint or a foreign key constraint, it will be aborted to maintain the consistency of the database.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But decoupling your database means you lose all FK integrity so new you need something else. Distributed architectures rely heavily on eventual consistency as a trade-off for better operational architecture characteristics such as performance, scalability, elasticity, fault tolerance, and availability. While there are numerous ways to achieve eventual consistency between data sources and systems, the three main patterns in use today are the background synchronization pattern, orchestrated request-based pattern, and the event-based pattern.&lt;/p&gt;
&lt;p&gt;So we require something else, which is BASE. BASE means:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Basically Available&lt;/strong&gt; means that the system should remain operational and responsive, even in the face of failures. It prioritizes availability over consistency. In other words, the system might return slightly outdated or inconsistent data during certain operations, but it ensures that the system remains accessible and operational.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Soft state&lt;/strong&gt; refers to the idea that the state of the system may change over time, even without input. Unlike in ACID systems, where the state is always consistent and deterministic, in BASE systems, the state might be transient or mutable. This allows for more flexible and scalable designs, particularly in distributed systems where maintaining strong consistency across all nodes can be challenging.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Eventually consistency&lt;/strong&gt; means that the system will eventually reach a consistent state after a period of time, given no further input. Unlike the immediate consistency guaranteed by ACID transactions, eventual consistency allows for temporary inconsistencies between different replicas or partitions of data. Over time, through mechanisms like gossip protocols, reconciliation, or background processes, these inconsistencies are resolved, and the system converges to a consistent state.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So as we can see, the constraints are much lower. Let’s look at some patterns for inter service communication.&lt;/p&gt;
&lt;h3&gt;Interservice Communication Pattern&lt;/h3&gt;
&lt;p&gt;The simplest form of microservice communication is for one microservice to call another one directly. The main advantage of this approach is simplicity, but there are quite a few drawbacks.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Tight coupling&lt;/strong&gt;. If service A depends on service B, any schema change in the response will affect it. Consider that a central tenet of microservices is being able to individually develop and deploy them, this form of tight coupling can cause problems.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Scalability issues&lt;/strong&gt;. A benefit of independent microservices is they can also be scaled independently. But if a service depends on another service, that service can become a performance bottleneck.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Error handling&lt;/strong&gt;. The 3rd party service might have crashed, which in turn takes down the services using it.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So let’s look at a way around these.&lt;/p&gt;
&lt;h3&gt;Data Duplication Pattern&lt;/h3&gt;
&lt;p&gt;On order to avoid direct calls between microservices, we can duplicate data. In our above example, the reports service would store its own user summary table in its own database. We would use a&lt;/p&gt;
&lt;p&gt;The main drawback of this is async code is harder to maintain and to understand that synchronous code.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Language Performance Doesn't Matter (Most Of The Time)]]></title><description><![CDATA[Here’s something that might be a bit controversial: I believe that for most software projects, the performance of the language (C#, Golang…]]></description><link>https://florintoader.me/2024-03-08-performance/</link><guid isPermaLink="false">https://florintoader.me/2024-03-08-performance/</guid><pubDate>Fri, 08 Mar 2024 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;Here’s something that might be a bit controversial: &lt;em&gt;I believe that for most software projects, the performance of the language (C#, Golang, PHP, Ruby) doesn’t matter that much. The reason I am writing this article is that I’ve seen an almost cultlike obsession with various languages and tech stacks, to the point where teams are pushing for a complete rewrite of the application. Even if there isn’t a push for a complete rewrite, there usually is a push for a &lt;em&gt;polyglot&lt;/em&gt; microservice setup, which has its own problems.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I believe this is  not warranted for most projects, and I’ll explain why. But first, let’s look at a benchmark showing raw performance for different languages.&lt;/p&gt;
&lt;img src=&quot;perf.jpg&quot; class=&quot;img&quot; loading=&quot;lazy&quot; /&gt;
&lt;p&gt;As we can see, there’s quite a big difference between, say C and PHP, and if you were to implement a game, or a database engine, the choice of language would matter &lt;em&gt;a lot&lt;/em&gt;. But most projects aren’t relational database engines or games, they are web applications. And most applications actually use frameworks, written on top of a language, which interact with native code. But before we get into specifics, let’s look at code optimization, or specifically an approach to code optimization.&lt;/p&gt;
&lt;h3&gt;Inner Loop Optimization&lt;/h3&gt;
&lt;p&gt;A common theme when thinking about optimizing code is the concept of &lt;em&gt;inner loop optimization&lt;/em&gt;. Consider the following code:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; before &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; after &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; inner &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; n &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;10&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; i &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; i &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;100&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; i&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;++&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;before&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;++&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;j&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;j&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;100&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;j&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;++&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;inner&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;++&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;after&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;++&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; before&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; inner&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; after &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Output for n equals 10.&lt;/p&gt;
&lt;pre class=&quot;shiki-unknown&quot;&gt;&lt;code&gt;{ before: 10, inner: 100, outer: 10 }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And for n equals 100.&lt;/p&gt;
&lt;pre class=&quot;shiki-unknown&quot;&gt;&lt;code&gt;{ before: 100, inner: 10000, outer: 100 }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We quickly see that the inner loop takes much longer than the outer loop, and this gets more and more pronounced, the bigger n is. Now imagine we have three loops, or four loops. It gets progressively worse. A lot of code uses inner loops, and while the lines of code of the functionality in the inner loop might not necessarily be more than the outer loop, they have significantly more impact on performance. Which is why a lot of optimizing efforts are targeted on the inner loop code.&lt;/p&gt;
&lt;p&gt;When comparing a normal rendered picture, we can see that the polygon vertexes (corners) are much lower in number than the number of pixels. And the per pixel correct texture mapping happens inside the inner loop, where performance matters. Also, correct texture mapping requires two divides per pixel and is quite expensive. So the inner loops were written in assembly (and texture correction was done every 8 pixels—the code used linear interpolation in between).&lt;/p&gt;
&lt;h3&gt;The Classic 3-Tier Architecture&lt;/h3&gt;
&lt;p&gt;This is quite academic, so how does this help is? We need to consider a typical web app using a 3-tier architecture.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Your API gets an HTTP request.&lt;/li&gt;
&lt;li&gt;Based on this request, you run some authorization /  request validation logic.&lt;/li&gt;
&lt;li&gt;If validation logic passes, you run some business logic code.&lt;/li&gt;
&lt;li&gt;This logic reads or writes to a database, usually using an ORM.&lt;/li&gt;
&lt;li&gt;The ORM code generates SQL, which is run against a relational database.&lt;/li&gt;
&lt;li&gt;This SQL is translated into an execution plan.&lt;/li&gt;
&lt;li&gt;The results are returned to the API, then mapped and returned to the caller.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can ask ourselves what the inner loop would be here. That would be the SQL execution plan. In fact, if you do some profiling, you will find that most of the time is being spent on the database level.&lt;/p&gt;
&lt;p&gt;Here’s an example of a simple execution plan.&lt;/p&gt;
&lt;pre class=&quot;shiki-unknown&quot;&gt;&lt;code&gt;------------------------------------------------------------------------------
| Id | Operation           | Name        |Rows | Bytes |Cost (%CPU)| Time    |
------------------------------------------------------------------------------
|  0 | SELECT STATEMENT    |             |   4 |   124 |   5  (20)| 00:00:01 |
|  1 |  SORT ORDER BY      |             |   4 |   124 |   5  (20)| 00:00:01 |
|* 2 |   HASH JOIN         |             |   4 |   124 |   4   (0)| 00:00:01 |
|* 3 |    TABLE ACCESS FULL| CATEGORIES  |   4 |    60 |   2   (0)| 00:00:01 |
|  4 |    TABLE ACCESS FULL| PRODUCTS    |  27 |   432 |   2   (0)| 00:00:01 |
------------------------------------------------------------------------------&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What happens here is:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The engine doesn’t an inner join between the categories and products using the hash join algorithm.&lt;/li&gt;
&lt;li&gt;It sorts the output of this join, and selects only some columns.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;While a hash join can be quite performant, the sort is costly. Also, keep in mind that the execution plan you are getting depends both on what indexes you have in the databases, as well as the ORM. And yes, ORM performance does matter.&lt;/p&gt;
&lt;p&gt;Here is an interesting graph comparing the performance of different ORMs available for Node.js.&lt;/p&gt;
&lt;img src=&quot;performance.png&quot; class=&quot;img&quot; loading=&quot;lazy&quot; /&gt;
&lt;p&gt;As you can see, there are other factors that matter a lot more than if you’re using C# instead of PHP.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Understanding Time Versus Space Performance Tradeoffs]]></title><description><![CDATA[As developers, we use hash tables on a daily basis (directly or indirectly) because they are ubiquitous in software. Yet if you ask most…]]></description><link>https://florintoader.me/2024-03-09-tradeoff/</link><guid isPermaLink="false">https://florintoader.me/2024-03-09-tradeoff/</guid><pubDate>Wed, 06 Mar 2024 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;As developers, we use hash tables on a daily basis (directly or indirectly) because they are ubiquitous in software. Yet if you ask most developers, they would not be able to explain how they work, so why not provide a simple explanation here?&lt;/p&gt;
&lt;p&gt;Let’s assume you have a list of users, and you want to show the details for a user based on username. Since lists are usually implemented as linked lists under the hood, finding the element means iterating through the whole list, which is an O(n) operation. This is different from
accessing an array, which can be done by index. This is an O(1) operation. So what if we wanted to have something similar? We would need to store the usernames in an array under the hood, and somehow “convert” the username string to an index.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;stringToNormalizedNumber&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// calculate the sum of character codes&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;charCodeSum&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;reduce&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;sum&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;char&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;sum&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;char&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;charCodeAt&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// combine string length and character code sum&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;str&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;length&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;charCodeSum&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// normalize to the range of 0 to 1, assuming 32-bit character codes&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;normalizedRange&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Math&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;pow&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can come up with a checksum function, for example. This isn’t a great way to do it, but it will do, as an example.&lt;/p&gt;
&lt;p&gt;So what we do is we calculate the index based on the string. You will notice that:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;There will be a lot of empty space in the array.&lt;/li&gt;
&lt;li&gt;There can be collisions, meaning that two different strings can have the same numeric index.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So what we do is instead of just storing a user at each point in an array, we can store a list of users with the same checksum (called a bucket). So when we access an element, we actually iterate through the list and check against the username. Normally you shouldn’t have more than a few items in the list anyway. The bigger the array used, the smaller the chance of a collision, but obviously the more memory will be needed.&lt;/p&gt;
&lt;img src=&quot;hash.jpg&quot; class=&quot;img&quot; loading=&quot;lazy&quot; /&gt;
&lt;p&gt;&lt;em&gt;In ideal circumstances, the size of the array would be infinite, and access time would be O(1), but that’s not realistic. What we have is a tradeoff between access time and space.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;Caching / Materialized Views&lt;/h3&gt;
&lt;p&gt;The simplest example of space versus execution time tradeoff that you’ll routinely encounter is caching. While a “dumb” cache can be easy to implement, &lt;em&gt;cache invalidation&lt;/em&gt; is by no means a simple problem, so a common issue is out-of-date data.&lt;/p&gt;
&lt;p&gt;An alternative to caching are materialized views, which is also a tradeoff. Imagine you have a complex query that is computationally expensive, and an application that is read heavy (say 100:1 read to write ratio). An interesting thing about materialized queries is they denormalize the data, which also means data duplication in itself. Let’s consider a very simple example, we have users and each user can define a set of addresses to which they can make orders online, in an online store.&lt;/p&gt;
&lt;img src=&quot;schema.png&quot; class=&quot;img&quot; loading=&quot;lazy&quot; /&gt;
&lt;p&gt;A cross join between them results in data duplication. A lot of document stores like MongoDB employ denormalization, for example, and this makes them easy to scale horizontally (shard).&lt;/p&gt;
&lt;h3&gt;Sharded Databases Also Require Data Duplication&lt;/h3&gt;
&lt;p&gt;Sharding spreads your database &lt;em&gt;horizontally&lt;/em&gt; over a number of nodes, along some &lt;em&gt;dimension&lt;/em&gt;. In the above case, we could spread requests to nodes by user id. A very simple strategy would be to say that first node handles requests for user id in range [1, 1000], the second in range from [1001, 2000] and so on. Of course, some users can have more orders than others, etc. which leads to &lt;em&gt;hotspots&lt;/em&gt;, so using an equal number of users per node isn’t the optimal strategy.&lt;/p&gt;
&lt;p&gt;A slightly more advanced technique (like what Azure uses) is to use a shard map manager, but this is beyond the point of this article.&lt;/p&gt;
&lt;img src=&quot;sharding.png&quot; class=&quot;img&quot; loading=&quot;lazy&quot; /&gt;
&lt;p&gt;With sharding, you have two types of tables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sharded tables.&lt;/li&gt;
&lt;li&gt;Replicated tables.&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&quot;apic.svg&quot; class=&quot;img&quot; loading=&quot;lazy&quot; /&gt;
&lt;p&gt;Also, each node has the same schema, and FK constraints are kept intact. So &lt;code&gt;User&lt;/code&gt;, &lt;code&gt;UserAddress&lt;/code&gt; and &lt;code&gt;UserOrder&lt;/code&gt; will be sharded , while the &lt;em&gt;SupportedCountries&lt;/em&gt; will be replicated. Again, this is a form of data duplication, and it’s a price we play&lt;/p&gt;
&lt;h3&gt;Covering Indexes Are A Form Of Materialized Views&lt;/h3&gt;
&lt;p&gt;A common approach to fix read performance issues is to add indexes on the queried fields, including &lt;em&gt;covering indexes&lt;/em&gt;, which are compound indexes that include all fields used in a specific query. The reason for including all the fields used in the query is for the database engine to be able to retrieve the data from the index itself, without having to look up the data in the actual table.&lt;/p&gt;
&lt;p&gt;Keep in mind this is does not only take up space on the disk, but it also means that these indexes need to be balanced, since indexes are B+trees (balanced trees).&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Should I Pre-Decouple Modules In My Modular Monolith?]]></title><description><![CDATA[First, when creating a new application, should you start off with a microservice architecture? Well, the prevailing wisdom is no, because…]]></description><link>https://florintoader.me/2024-01-06-modules/</link><guid isPermaLink="false">https://florintoader.me/2024-01-06-modules/</guid><pubDate>Sat, 06 Jan 2024 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;First, when creating a new application, should you start off with a microservice architecture? Well, the prevailing wisdom is no, because there is significant cost associated with maintaining, deploying and hosting multiple microservices.&lt;/p&gt;
&lt;p&gt;Let’s also look at some microservice tenets:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Microservices need to own their own data, which means you need a database for each.&lt;/li&gt;
&lt;li&gt;Instead of synchronous communication, you usually use message based communication to ensure decoupling.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So what does this mean?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;We lose FK constraints, and data integrity related to them.&lt;/li&gt;
&lt;li&gt;Joins across data sources can be tricky.&lt;/li&gt;
&lt;li&gt;Distributed transactions can also be tricky.&lt;/li&gt;
&lt;li&gt;We lose some data normalization (for example, catalog data will probably have to be replicated).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;What is the alternative? Well, writing a monolith. Monoliths in themselves aren’t bad—actually, the term monolith refers to a unit of deployment, and in fact most projects use a monolithic architecture. You can even have a distributed monolith because if the dependencies between microservices are as such that you need to deploy multiple of them at the same time. The only potential problem arises if, at some later point, we want to move to a microservice architecture, those FK constraints will pose a problem. What would be a possible approach? Create a monolith with predefined modules and enforce strict domain boundaries.&lt;/p&gt;
&lt;img src=&quot;modules2.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;We would aim for something like this.&lt;/p&gt;
&lt;h2&gt;A Case Study&lt;/h2&gt;
&lt;p&gt;Let’s define a set of spec for an application.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;We want to build an online shopping platform where multiple vendors can sell products. Multiple venders can sell the same product (defined by SKU). We would have system admins, vender admins and regular users.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Well start by defining a set of entities:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Product&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ProductCategory&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;User&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;UserAddress&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ProductReview&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;UserAddress&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Vendor&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let’s try to sketch a database schema.&lt;/p&gt;
&lt;img src=&quot;first.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;OK, that was the first draft. Now, let’s do a mental exercise. Let’s think what would be needed in order to break this monolith. We would need to identify a set of domain boundaries, which would correspond to the individual microservices. We won’t actually create microservices, but we will look at what we need to do for our code to be &lt;em&gt;splittable&lt;/em&gt;, so let’s move things around.&lt;/p&gt;
&lt;img src=&quot;middle.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;OK, this looks cleaner. As we see, we have created groups of related objects, grouped around users, products, and vendors. They would need to correspond to individual modules / microservices. We can now define a few microservices:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Authentication&lt;/em&gt;, related to users.&lt;/li&gt;
&lt;li&gt;Search and product details.&lt;/li&gt;
&lt;li&gt;Payment.&lt;/li&gt;
&lt;li&gt;Catalog and search, related to products.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In order to separate them into separate modules, we would need to remove the FK constraints. Of course, the question becomes then, how would they communicate. My approach is to use unique domain properties such as the user id, or some company tax code. This is what we will do here.&lt;/p&gt;
&lt;img src=&quot;final.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;That is exactly what we’ve done. And we’ve also removed the permission tables, and we’ll use string keys instead, for example, &lt;code&gt;ADMIN&lt;/code&gt;, &lt;code&gt;VENDOR&lt;/code&gt;, &lt;code&gt;CUSTOMER&lt;/code&gt;. The permission level would come from the user session (as claims).&lt;/p&gt;
&lt;h3&gt;Some Thoughts On Module Communication&lt;/h3&gt;
&lt;p&gt;Decoupling your data model won’t achive anything if individual services in your app are coupled (call one another directly). We know that in the microservice world, direct calls are a no-no. So in order for our microservices to be decoupled, we would need to also decouple our service layer, not just data layer.&lt;/p&gt;
&lt;p&gt;One approach to communication would be to use a message bus. Since your client application will probably make use of push notifications, you’ll use messeging anyway, in conjuction with module communication. This is called &lt;em&gt;coreography&lt;/em&gt;. The other approach is to use &lt;em&gt;orhestration&lt;/em&gt;, which is usually done on the client, because as I’ve mentioned, we want to avoid direct synchronous calls between microservices.&lt;/p&gt;
&lt;p&gt;Let’s assume we have a Payment service, and it needs to synchronize with the Catalog service. Let’s describe the flow:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;When the user initiates a payment, the product needs to be reserved in the Catalog service.&lt;/li&gt;
&lt;li&gt;This will in turn send a message acknowledging that the product is indeed reserved, so that if another customer tries to place an order, it will manage the stock levels appropriately.&lt;/li&gt;
&lt;li&gt;Once this worked, payment processing will begin.&lt;/li&gt;
&lt;li&gt;If payment succeeds, another message will be sent to the Catalog service, and stocks will be decreased by one.&lt;/li&gt;
&lt;li&gt;Otherwise, the reserved status will be removed.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The client can also do orchestration and call these steps in order, but this isn’t recommended for business logic flows, especially not for business flows. We’ve just described a distributed transaction.&lt;/p&gt;
&lt;p&gt;There are several ways to do distributed transactions.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Three phase commits.&lt;/li&gt;
&lt;li&gt;Two phase commits.&lt;/li&gt;
&lt;li&gt;Sagas.&lt;/li&gt;
&lt;li&gt;Compensating transactions.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;But there will be a special article for that.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Gamification Leads To People Gaming The System]]></title><description><![CDATA[Something I’ve seen more and more in SCRUM teams is the concept of gamification. Gamification is the process of applying game-like elements…]]></description><link>https://florintoader.me/2024-01-05-gamification/</link><guid isPermaLink="false">https://florintoader.me/2024-01-05-gamification/</guid><pubDate>Mon, 01 Jan 2024 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;Something I’ve seen more and more in SCRUM teams is the concept of gamification. Gamification is the process of applying game-like elements and mechanics to non-game contexts to enhance user engagement, motivation, and overall experience. It involves incorporating game design elements such as points, badges, leaderboards, challenges, and rewards into non-game activities, such as marketing campaigns, educational programs, workplace training, and even daily tasks.&lt;/p&gt;
&lt;p&gt;Apparently, the goal of gamification is to tap into the natural human desire for challenge, competition, and social interaction that we experience when playing games.&lt;/p&gt;
&lt;img src=&quot;stack.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;By incorporating these elements into non-game activities, gamification can make them more engaging, motivating, and ultimately more successful. Or so it is argued.
In theory, this sounds great. Except for when it isn’t.&lt;/p&gt;
&lt;p&gt;It’s argued that gamification can foster social connection by providing opportunities for collaboration, competition, and peer recognition in your team, because it introduces an element of playfulness in the SCRUM and development process, but I’ve found the opposite to be true in a lot of cases. Gamification is always tied to metrics, e.g., number of story points closed or tickets.&lt;/p&gt;
&lt;h2&gt;Chasing (Story) Points&lt;/h2&gt;
&lt;p&gt;In hid infamous title defense against Demian Maia, the Anderson Silva used a simple strategy. Knowing that Maya is a Brazilian Jiu Jitsu phenom, he tried to avoid getting into close contact at all costs, simply resorting to a strategy where he would pepper him with shots from&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In fact, he did the bare minimum to win the fight and retain his title.&lt;/em&gt;&lt;/p&gt;
&lt;img src=&quot;interview.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;He won on points, and that was the whole strategy.&lt;/p&gt;
&lt;p&gt;Imagine an NBA team. Not all players have the same role. Now imagine that all players are evaluated based on the number of points they score. What will happen is instead of the players working as a team, they will compete for the ball between themselves, as well as against the other team.&lt;/p&gt;
&lt;p&gt;In many companies, various metrics will be used in conjunction with stack ranking, which is now an infamous tactic.&lt;/p&gt;
&lt;p&gt;In November 2013, Microsoft Corp. announced it had ended its controversial “stack ranking” employee-review and compensation system and no longer requires managers to grade employees against one another and rank them on a scale of 1 to 5. The most contentious aspect of this approach was
its targeted, or forced, distribution requirements, which meant managers had to designate a small percentage of their direct reports as underperformers.&lt;/p&gt;
&lt;p&gt;Stack ranking, also known as forced ranking, is an employee evaluation method that categorizes employees into a predetermined distribution of performance levels, typically a bell curve. This method is commonly used in software development companies to assess and compare the performance of their employees. In stack ranking, managers are tasked with placing each employee within a specific performance category, such as “exceeds expectations,” “meets expectations,” “needs improvement,” or “underperforms.” This process often involves comparing employees against each other, which can create a competitive and sometimes adversarial environment within teams.&lt;/p&gt;
&lt;h2&gt;Writing Software Is a Collaborative Effort&lt;/h2&gt;
&lt;p&gt;This cannot be said enough.&lt;/p&gt;
&lt;img src=&quot;remember.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;While stack ranking aims to identify and reward top performers, it has been criticized for its drawbacks and negative impacts on employee morale, motivation, and overall team dynamics.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You will always require assistance from other people when changing their code. If the environment is hostile, it might lead to information hiding.&lt;/li&gt;
&lt;li&gt;Merging your code requires passing code reviews, and some developers can develop passive-aggressive attitudes and reject pull requests for small teams. This in turn requires other developers to constantly task switch, etc. which can lead to frustration and wasted time.&lt;/li&gt;
&lt;li&gt;Developers might take shortcuts in how they write their code, just to be able to “close the task” and “get the story points” at the end of the sprint.&lt;/li&gt;
&lt;li&gt;Many times as a developer, you will be blocked by other tasks and sometimes all it takes is a small easy fix from a team member.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ultimately, my feeling is it leads to a zero-sum game mentality, and it should be used with caution.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Why It's So Hard To Get Estimations Right?]]></title><description><![CDATA[The estimation proces and estimation related time pressure are probably some of the most contentious aspects of software development, and it…]]></description><link>https://florintoader.me/2022-05-30-estimations/</link><guid isPermaLink="false">https://florintoader.me/2022-05-30-estimations/</guid><pubDate>Mon, 30 May 2022 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;The estimation proces and estimation related time pressure are probably some of the most contentious aspects of software development, and it is usual for project managers to try to push down initial estimations made by developers, either because of pressure placed on themselves by varios stakeholders or because they know that tasks tend to take up the whole allotted time (because of developer procrastination), or both. To make matters worse, a whopping 70% of projects are considered “failures” based on initial targets. Even if the teams use agile methodologies, a large number of the sprints will fail to meet their story point target.&lt;/p&gt;
&lt;h3&gt;An All Too Familiar Story&lt;/h3&gt;
&lt;p&gt;The Sydney Opera house is such an iconic building that for many people it’s the first thing that comes to mind when they think of Australia’s famous city, yet not many are aware of its troubled history and how it came to be built. In 1995, the then prime minister Joseph Cahill launched an international design contest and after reviewing 233 entries from architects in thirtytwo countries, Danish architect Jørn Utzon was declared the winner, despite the fact that he simply entered a collection of pencil sketches outlining only the shape of the building.&lt;/p&gt;
&lt;img src=&quot;sketch.jpeg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;There were no interior plans, or plans for the support structure. Nevertheless, based on Utzon’s vision, the Australian government gave the construction works the green light, even before the schematics could be finalized, in order to capitalize on the existing enthusiasm and political support for the project. Little would they know that the project would exceed the budget by a factor of ten, and the whole process would take ten years, more than the three initially devised.&lt;/p&gt;
&lt;p&gt;To maximize time, the support columns were built before the design of the roof was finalized. And once the design was completed, the columns proved too weak to support it, so all of them had to be removed and replaced. So why did the roof design take so long? Since such a structure had never been built before, the engineers didn’t know how to go about it, and no less than 14 designs had to be proposed before settling on the final one, a design that would be feasible.&lt;/p&gt;
&lt;p&gt;The opera house scenario bears a lot of similarities with a lot of software projects. These start with the ideation phase, and then investors are keen to move fast to capture a market segment, since agile methodologies very popular right now. Let’s examine some concepts involved.&lt;/p&gt;
&lt;h3&gt;Brook’s Law&lt;/h3&gt;
&lt;p&gt;In his famous book, The Mythical Man Month, Fred Brooks argues that adding developers to a late project makes it even more late (which has since came to be known as Brook’s law).&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Another way to put it is, if a woman can deliver a baby in nine months, it doesn’t mean that three women can deliver a baby in three months.&lt;/em&gt;&lt;/p&gt;
&lt;img src=&quot;dilbert.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;Throwing more people at a problem is one of the most common productivity traps that you can fall into, and not just because of the increase in coordination efforts. Some tasks cannot be partitioned effectively and don’t scale well with more developers. In fact, attempting to do it makes matters worse because there is now communication overhead, potential blocking and merging conflicts, etc.&lt;/p&gt;
&lt;p&gt;Like communication between components, the number of pathways scales with O(n^2). It also takes quite a bit of time for developers to become productive on a specific project if they aren’t familiar with it, and they will need support, which takes away productive time from the experienced devs.&lt;/p&gt;
&lt;h3&gt;Exactly Predicting The Behavior Of Nonlinear Systems Is Hard&lt;/h3&gt;
&lt;p&gt;Let’s consider a very simple physical system, the double &lt;a href=&quot;https://en.wikipedia.org/wiki/Double_pendulum&quot;&gt;pendulum&lt;/a&gt;. Even if this is a system that’s very simple and its behavior is fully deterministic (we can write down the equations of motion), its time evolution is chaotic.&lt;/p&gt;
&lt;img src=&quot;chaos.jpeg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;Teams of developers are complex systems. Communication between team members, dependencies, etc., all play a role, making exact progress tracking difficult, so a team behaves as a chaotical physical system in many ways.&lt;/p&gt;
&lt;p&gt;This is not to say we can’t say anything about the system, but there will be a considerable degree of uncertainty.&lt;/p&gt;
&lt;h3&gt;The Dunning Kruger Effect And Optimism Bias&lt;/h3&gt;
&lt;p&gt;According to Wikipedia:&lt;/p&gt;
&lt;p&gt;&lt;i&gt;The Dunning–Kruger effect is a cognitive bias whereby people with low ability, expertise, or experience regarding a certain type of a task or area of knowledge tend to overestimate their ability or knowledge. Some researchers also include in their definition the opposite effect for high performers: their tendency to underestimate their skills. The Dunning–Kruger effect is usually measured by comparing self-assessment with objective performance.&lt;/i&gt;&lt;/p&gt;
&lt;!-- &lt;img src=&quot;dunning.svg&quot; class=&quot;img&quot; /&gt; --&gt;
&lt;p&gt;We tend to be overly optimistic when we don’t know enough about a certain subject. Also when doing estimations, even if devs estimate in story points, they think in time and revert back to storypoints — and they usually assume the best outcome. However, in real life unexpected things happen:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;They might get a spec from the designer, only to find out mid-estimation that the UX design doesn’t translate well into CSS (more on that later).&lt;/li&gt;
&lt;li&gt;They might get a spec from the product owner and implement it, only to find that the spec is incomplete or the PO meant something else in the spec (because of inconsistent domain language).&lt;/li&gt;
&lt;li&gt;Or that the implementation actually requires a complicated database migration that wasn’t factored in.&lt;/li&gt;
&lt;li&gt;Or that breaking changes / major refactoring is required midway through implementation.&lt;/li&gt;
&lt;li&gt;They might implement the happy path, but miss edge cases, only for the testers to pick them up.&lt;/li&gt;
&lt;li&gt;In the process of implementation, they might find bugs in some of the libraries they are using, or simply that the libraries don’t support what they are trying to do.&lt;/li&gt;
&lt;li&gt;After implementing the functionality, the performance might not be acceptable.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When estimating, there’s a natural tendency amongst most developers to think they can go from start to finish in a straight line, but that’s rarely the case. You might get to where you think you’re 90% done, only for you to discover there’s another 90% to go (to paraphrase John Carmack).&lt;/p&gt;
&lt;p&gt;Expectation versus reality:&lt;/p&gt;
&lt;img src=&quot;progress.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;If developers don’t know enough about how to tackle a piece of functionality, they will not be able to properly estimate it, is which case a technical user story (or spike) needs to be scheduled before the actual implementation. Spikes come from Extreme Programming (XP), are a special type of user story that is used to gain the knowledge necessary to reduce the risk of a technical approach, better understand a requirement, or increase the reliability of a story estimate. A spike has a maximum time-box size as the sprint it is contained in it. At the end of a sprint, the spike will be determined that is done or not-done just like any other ordinary user story.&lt;/p&gt;
&lt;p&gt;Estimation is usually done as a team during the planning phase of the sprint, but there will be developers that specialize in different areas of the application, yet everybody will be required to provide an estimation (usually in the form of story points). Somebody that’s very familiar with the code in one area might come up with a higher estimation (because they understand the risks or potential complications inolved), head but succumb to team/peer pressure from the team to revise their estimation lower, because they are in the minority. Sometimes developers might pretend to believe that something is easy knowing it reflects well on them and it isn’t them who will build that piece of functionality (which is a form of office politics).&lt;/p&gt;
&lt;h3&gt;Finessing UX Is One Of The Most Time Consuming Aspects Of Development&lt;/h3&gt;
&lt;p&gt;The output of a designer (using tools like Adobe XD or Figma) will usually not translate directly 1:1 to CSS / HTML because design tools tend to use absolute positioning, whereas HTML uses a flowing layout. What usually ends up happening is the output is subtly different from what the designer expects, which means they will come back with changes.&lt;/p&gt;
&lt;p&gt;In some cases, it is possible to do them; in other cases, a compromise will have to be reached, which takes time, and several iterative steps might be needed.  Another issue is developers tend to think in components, and when using a framework such as React, they will have a set of building reusable blocks already prebuilt. Designers focus more on UX and that might not translate well into reusable components. Communication and collaboration is key to ensure that designers don’t come up with a design that isn’t pheasible.&lt;/p&gt;
&lt;h3&gt;Time Based Estimations Are Flawed&lt;/h3&gt;
&lt;p&gt;First of all, developers don’t work full eight hours per day. This is quite self-explanatory, and most teams consider effective work to be six hours per day, but even this is inaccurate. In his book The Shallows: What The Internet Is Doing To Our Brins, Nichlas Karr explains how the advent of the internet, multi-tasking, and social media has changed how our brain works.&lt;/p&gt;
&lt;p&gt;Since a lot of the applications we use are designed to be addictive.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Checking email.&lt;/li&gt;
&lt;li&gt;Checking social media.&lt;/li&gt;
&lt;li&gt;Receiving error log notifications.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On top of that:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Being interrupted by coworkers on Slack.&lt;/li&gt;
&lt;li&gt;Working from home poses new challenges — like being interrupted by family members.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It takes an average of about 25 minutes (23 minutes and 15 seconds, to be exact) to return to the original task after an interruption, according to Gloria Mark, who studies digital distraction at the University of California, Irvine. Multiple studies confirm this, so it’s safe to say that the actual effective time spent coding is significantly less than six hours.&lt;/p&gt;
&lt;p&gt;When we do estimations, we need to consider relative ones. So a story point should not be defined in time but rather in relation to another user story. This way we can escape the pitfall of unreliable time-based estimations.&lt;/p&gt;
&lt;p&gt;Also, if you are doing &lt;a href=&quot;https://en.wikipedia.org/wiki/Planning_poker&quot;&gt;planning poker&lt;/a&gt;, you might have noticed that the numbers on the cards (roughly) follow the Fibonacci sequence. As user stories get bigger, the uncertainty factor also gets larger, and things can spiral out of control. It is recommended to use a threshold for splitting stories into smaller ones — it doesn’t matter what the value is, it might be 5, it might be 20. It indicates that a story might be too big to estimate properly and should be an epic instead, or just several smaller user stories.&lt;/p&gt;
&lt;h3&gt;In Closing&lt;/h3&gt;
&lt;p&gt;There are several things teams can do in order to improve estimates:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use a strict domain language — this way important details aren’t lost in translation between product owners and developers. Don’t user interchangable terms such as “account” or “user”, as they might refer to different things.&lt;/li&gt;
&lt;li&gt;Make sure stakeholders understand the value of spikes — yes, there’s upfront cost to doing them, but it’s worth it in the long run.&lt;/li&gt;
&lt;li&gt;Get your designers on board with Atomic Design. If they are familiar with CSS and HTML, even better.&lt;/li&gt;
&lt;li&gt;Before building UI pages, get into the habit of first indentifying and building the needed components.&lt;/li&gt;
&lt;li&gt;Use Storybook to test these components in isolation.&lt;/li&gt;
&lt;li&gt;Use a self management technique like Pomodoro to manage your time, and work in uninterupted bursts.&lt;/li&gt;
&lt;li&gt;Resist the urge to go to time based estimations and always resort to relative comparisons between user stories: ask questions like “do you feel this 3 point user story is three times as complex as this one which is only 1 SP?“.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[You Probably Don't Need CQRS]]></title><description><![CDATA[CQRS has been popular for quite a few years (more than a decade old at this point), and while it’s no longer in the hype phase of adoption…]]></description><link>https://florintoader.me/2022-02-27-cqrs/</link><guid isPermaLink="false">https://florintoader.me/2022-02-27-cqrs/</guid><pubDate>Sun, 27 Feb 2022 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;CQRS has been popular for quite a few years (more than a decade old at this point), and while it’s no longer in the hype phase of adoption, it still gets brought up quite a bit during architectural discussions for new projects (usually in conjunction with microservices). A few years after the pattern became popular, there was mounting criticism against it, mainly because of the complexity it introduces - with critics citing it as a typical example of over-engineering / premature optimization. As with most new technologies, this is captured very well by the Gartner hype cycle graph.&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;img src=&quot;hype.png&quot; class=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;p&gt;The adoption curve for microservices was similar: they were initially everywhere, then there was a backlash against the approach, and eventually teams began using them more judiciously. This pattern is typical for many new frameworks as well:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Phase 1:&lt;/strong&gt; Hey, look, a new shinny toy is out—I want to play with it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Phase 2:&lt;/strong&gt; OK, this isn’t really what I expected, it’s really bad.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Phase 3:&lt;/strong&gt; Maybe we shouldn’t have used it for everything, but it does have a place for certain usecases.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dismissing CQRS out of hand would be a mistake however, as it does serve a purpose, albeit a very specific one. The purpose of this article is to give a birds-eye view of the pattern, encourage its use where it’s suitable, and potentially dissuade developer teams from adopting it where it isn’t.&lt;/p&gt;
&lt;h3&gt;Architecture&lt;/h3&gt;
&lt;p&gt;Before CQRS we had CQS (Command Query Segregation) which is a pattern that can be attributed to Bertrand Mayer. You are probably using this pattern without even know you are — in a nutshell it posits that asking a &lt;em&gt;question shouldn’t change the answer&lt;/em&gt;. This means you don’t want a method to mutate your state and return a value at the same time.&lt;/p&gt;
&lt;p&gt;CQRS stands for Command Query Responsibility Segregation. It means that the read and write parts of the application are separated. Here are high-level schematics of the topologies of the two architectures, presented side by side.&lt;/p&gt;
&lt;img src=&quot;x.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;At first look, CQRS looks significantly more complicated than the standard approach because not only are there two pipelines now, it also involves using two data stores. We’ll clarify the purpose behind this in a moment.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;As a general rule of thumb, applications involve significantly more reads than writes.
Also, it’s not possible to optimize our data model for reads and writes at the same time. Themore
we imporove on read speed, by way of indexes, the slower the inserts become. Another approach to speed up reads is
to denormalize your data, to avoid having to perform costly joins.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;A Typical Example&lt;/h3&gt;
&lt;p&gt;Let’s look at a real world example: a post on social media has a series of comments but do you want to  tie those comments to the post object or to the user making the post? If so, how do we scale? CQRS can be a solution here - in our view cache, we can duplicate the comments, one time for the article and another time for the user’s history actions. A notification can be sent to update the cached view.&lt;/p&gt;
&lt;p&gt;Let’s look at a case where this might be needed:&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;img src=&quot;feed.png&quot; class=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;p&gt;So why not use a caching solution instead? The core value proposition of CQRS is the decoupling of the view model and the domain model in a distributed application.&lt;/p&gt;
&lt;p&gt;For the sake of argument, let’s consider that our application uses at least dozens of servers, which means we need a scaling solution for it. A typical horizontal scaling strategy would be to partition the data based on user id, but the question then becomes: &lt;em&gt;do we tie the comments to the user making them, or to the post which is in turn tied to another user. Also bear in mind that we want to avoid querying multiple nodes.&lt;/em&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The domain model is the primary source of truth, denormalized, and usually stored in a relational database.&lt;/li&gt;
&lt;li&gt;The view model contains data duplication and is normally stored in a fast document database.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This approach naturally lends itself to a microservice solution, where we can scale different parts of the application. Scaling out a relational database is complicated. Scaling out denormalized views is not.&lt;/p&gt;
&lt;p&gt;There is significant overhead associated with implementing CQRS and in most cases, there’s no need to separate the reading and writing pipelines. And in fact, it can be argued that the main advantage of CQRS is the fact that we have two storage formats, one that makes reading faster and one that denormalizes the data, not two pipelines. The former can be seen as a view model and the latter should be the primary source of truth.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In a nutshell, CQRS allows you to take a distributed data model and agregate it in one or more view models (caches). An analogy that can be used here, albeit not a perfect one, is the difference between a primary database and star-schema databases, which are optimized for reports.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;A Primer On Event Sourcing&lt;/h3&gt;
&lt;p&gt;The fundamental idea behind event sourcing is that the state of your application is given by a set of event objects. Let’s use an online store as an example.&lt;/p&gt;
&lt;p&gt;We start with an empty catalog, and we define events such as:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Adding support for new item types in the store catalog.&lt;/li&gt;
&lt;li&gt;Removing items from the supported catalog.&lt;/li&gt;
&lt;li&gt;Adding stock.&lt;/li&gt;
&lt;li&gt;Selling items.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Auditing is important when it comes to a wide variety of applications. You might be a financial controller. You might be maintainging an inspections sofwware and an audit trail is mandatory.&lt;/p&gt;
&lt;!-- The primary advantage here is we have a log of actions and this can be used for accounting purposes. Event sourcing  --&gt;
&lt;p&gt;If your application is using “event sourcing”, then it’s also customary to use CQRS.&lt;/p&gt;
&lt;h3&gt;Materialized Views&lt;/h3&gt;
&lt;p&gt;This isn’t a new concept. It has been around in relational database systems for quite some time now. The idea behind it was always to precompute the result of queries in order to improve response time. Sure, adding indexes can go a long way in improving read performance (at the expense of write performance), but if you’re reading the same data set again and agin, it makes sense to store it. In fact, adding views to your application might be one of the most efficient ways to improve performance.&lt;/p&gt;
&lt;p&gt;When we’re dealing with cloud native applications / distributed transactions etc., things are a bit more complicated. There is still value in the concept, but we can’t rely on our RDBMS system to do it for us — we’ll need to do it ourselves. A RDMS wil rely on its internal system of triggers — we’ll need a messaging system.&lt;/p&gt;
&lt;p&gt;As mentioned in other articles, distributed systems rely heavily on denormalization / data duplication. So even if we don’t need to keep a ledger to track our actions, thing such as “fan-out” (distributing data in the feed of various users on social media on say Twitter require data duplicationd).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You have the “primary source of truth”, which his what an individual user posted.&lt;/li&gt;
&lt;li&gt;And you also have a “materialized view”, which is the individual user’s feed.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As an approach, CQRS is useful when we want to achieve these “cloud native” materialized views.&lt;/p&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;As with most debates,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The decision to use CQRS should not be taken lightly, because it entails significant development cost.&lt;/li&gt;
&lt;li&gt;It most likely makes sense to use it if you’re planning to scale your storage solution.&lt;/li&gt;
&lt;li&gt;CQRS can be used on a per microservice basis - not all microservices need to use it.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Execution Contexts, Scopes and Closures]]></title><description><![CDATA[Closures are probably one of the most unintuitive features for newcomers to Javascript, especially if they come from languages such as Java…]]></description><link>https://florintoader.me/2022-02-26-js-closures/</link><guid isPermaLink="false">https://florintoader.me/2022-02-26-js-closures/</guid><pubDate>Sat, 26 Feb 2022 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;Closures are probably one of the most unintuitive features for newcomers to Javascript, especially if they come from languages such as Java or C#. The notion of a function within another function itself isn’t hard to understand, the significant hurdle in understanding comes with preserving the lexical environment around these functions once the parent function has finished executing. There are also quite a few articles that use misleading terminology — for example, context versus execution context, lexical environment versus scope, etc. We’ll aim to clarify the terms.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;An important concept to mention is that functions are first-class citizens in Javascript, whereas in C# / Java, it’s the classes that are first-class citizens. So even though a language like C# does support closures, they use some magic under the hood, as we’ll explain later.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;Scope&lt;/h3&gt;
&lt;p&gt;Let’s look at what &lt;em&gt;scope&lt;/em&gt; means first. Scoping simply means reducing the visibility of variables based on the block where they have been declared. The JS engine recognizes three types of scopes:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The global scope.&lt;/li&gt;
&lt;li&gt;Function scopes.&lt;/li&gt;
&lt;li&gt;Block scopes.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can consider the following piece of code:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; arrayItems &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; [&lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;4&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;logArrayItems&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;0&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;item&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;of&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;arrayItems&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;message&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;`&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;Array item &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;${&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt; is &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;${&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;item&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}`&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;message&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;++&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;logArrayItems&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is how it looks like:&lt;/p&gt;
&lt;img src=&quot;stack.svg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;In this case, the global scope contains &lt;em&gt;arrayItems&lt;/em&gt;, &lt;em&gt;i&lt;/em&gt; is in the function scope and &lt;em&gt;message&lt;/em&gt; is in the block scope. So far, this is intuitive, and it’s not that much different than what we would expect from a language like C#, Java, or C.&lt;/p&gt;
&lt;p&gt;Scopes form a chain. Variable resolution works as follows: if a variable isn’t available in the current scope, it goes up the chain.&lt;/p&gt;
&lt;h3&gt;Execution context&lt;/h3&gt;
&lt;p&gt;The term &lt;em&gt;context&lt;/em&gt; refers to what the &lt;em&gt;this&lt;/em&gt; keyword points to, which is different from &lt;em&gt;execution context&lt;/em&gt;, as we will see in a moment. Since JS is not an OOP imperative language (classes are just syntactic sugar), the value of the &lt;em&gt;this&lt;/em&gt; keyword depends on how the function is called (see &lt;em&gt;bind&lt;/em&gt; or &lt;em&gt;apply&lt;/em&gt;), but explaining it is beyond the scope of this article.  The &lt;em&gt;execution context&lt;/em&gt; is a general abstract term and refers to several things taken as a whole:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The value of &lt;em&gt;this&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;The lexical environment in which the code runs in — in the case of functions, that’s the outer scope.&lt;/li&gt;
&lt;li&gt;The code/function’s own variables.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When the JS engine starts a script, it creates something which is called a &lt;em&gt;global execution context&lt;/em&gt;. Each execution context has two phases:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The creation phase.&lt;/li&gt;
&lt;li&gt;The execution phase.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Javascript also introduces a concept called “hoisting”. This refers to variables being available before being declared, but contrary to what the term would intuitively suggest, nothing is actually being hoisted. Instead, what happens is the JS engine first does a pass through the code and determines which variables are declared and assigns an undefined value for them. The term “hoisting” comes from the illusion this gives that the declaration has been moved to the beginning of the block.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;showXandY&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;x is &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;x&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;y is &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;y&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;showXandY&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// we get undefined and undefined&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; x &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;12&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; y &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;14&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;showXandY&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// here, we get 12 and 14&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Also we have:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A global execution context.&lt;/li&gt;
&lt;li&gt;A function execution context.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;em&gt;&lt;b&gt;Remember:&lt;/b&gt; scope refers to the visibility of the variables, and context refers to where the code is executed.&lt;/em&gt;&lt;/p&gt;
&lt;h3&gt;Closures&lt;/h3&gt;
&lt;p&gt;Let’s look at a more complicated example:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; name &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;global variable&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;f1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;createClosure&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;f2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;starting...&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;f1&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;f2&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; g1 &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;createClosure&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;a&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; g2 &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;createClosure&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;b&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;c1&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;c2&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This seriously complicates things. First, we can see we can see thate &lt;em&gt;createClosure&lt;/em&gt; returns another function — so they really are objects. We create two instances, &lt;em&gt;g1&lt;/em&gt; and &lt;em&gt;g2&lt;/em&gt;. The first question would be which &lt;em&gt;name&lt;/em&gt; variable the &lt;em&gt;f1&lt;/em&gt; function “sees”, because it’s being run from &lt;em&gt;createClosure&lt;/em&gt;, but it’s being declared outside. The answer is it seems the variable in the global scope.&lt;/p&gt;
&lt;p&gt;If we run this, we get:&lt;/p&gt;
&lt;pre class=&quot;shiki-unknown&quot;&gt;&lt;code&gt;starting...
outer variable
a
starting...
outer variable
b&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What’s interesting is that &lt;em&gt;f2&lt;/em&gt; is able to display the value of the name parameter even though the &lt;em&gt;createClosure&lt;/em&gt; function has finished executing. This aspect captures what closures are all about.&lt;/p&gt;
&lt;p&gt;If a function returns a value that is another function (functions are objects), the JS engine creates a “closure” around it and preserves the returned function’s lexical environment that the inner function lives in at the moment it was created. This has several potential uses and also side-effects — a simple side effect is the one mentioned before — since React components are closures, they keep the value of &lt;em&gt;state&lt;/em&gt; at the moment the function was called (it acts as a render function), you cannot use a global state object per component and you cannot merge new partial state asynchroniously because other actions might have changed the state in the meantime. A simple example of closure can be the result returned by a React higher order component.&lt;/p&gt;
&lt;h3&gt;Closures For Private Fields&lt;/h3&gt;
&lt;p&gt;Closures are also interesting because they can be used to emulate private class data. While there are classes in JS, they are simply syntactical sugar over prototypical inheritance, and you can’t have private fields. Normally most developers wouldn’t need to know how closures work, but given how popular React’s functional components are (which make use of closures) and the amount of frustration not understanding them, a guide to explain them in detail is needed. With the advent of TypeScript however, we don’t need to do this.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;Person&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;firstName&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; lastName&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; age&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;let&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;_age&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;age&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;incrementAge&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;_age&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;showStats&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;`${&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;firstName&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;${&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;lastName&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;, age &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;${&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;_age&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}`&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;incrementAge&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;showStats&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; person1 &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;Person&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;John&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;Doe&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; person2 &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;Person&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;Jane&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;Doe&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;24&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(person1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;incrementAge &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; person2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;incrementAge) &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// false&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s try to unpack what happens here. The methods &lt;em&gt;incrementAge&lt;/em&gt; and &lt;em&gt;showStats&lt;/em&gt; live inside the &lt;em&gt;Person&lt;/em&gt; function scope. They “see” &lt;em&gt;firstName&lt;/em&gt;, &lt;em&gt;lastName&lt;/em&gt;, &lt;em&gt;age&lt;/em&gt; and &lt;em&gt;_age&lt;/em&gt; (which acts as a private variable). They constitute the lexical environment for these functions. When the outer function returns an object referencing these functions (and again keep in mind they are simply objects).&lt;/p&gt;
&lt;h3&gt;A Look At C# Closures&lt;/h3&gt;
&lt;p&gt;To illustrate how remarkable closures are, it’s worth pointing out what the .NET runtime does to support them (they are only supported from C# 7.0 and up).&lt;/p&gt;
&lt;p&gt;With C# / VB.NET in general, there has been a move towards a hybrid imperative/functional language, so support for “functions in functions” wasn’t unexpected. And, of course, scoping requires closures — so let’s look at how .NET achieves them.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;a&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;10&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;del&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F78C6C&quot;&gt;delegate&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  Console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;WriteLine&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;$&amp;quot;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;a is &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;x&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;);&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;};&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;del&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;();&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;C# uses the concept of a “delegate” to refer function objects that can be passed around - they are essentially reference types. The problem with delegates is that they don’t have any state, so when the C# compiler detects a delegate that forms a closure returned to the outside scope, the function and its associated local variables are promoted to a compiler-generated class. The compiler then treats the delegate as a method in this class.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;CompilerGenerated&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;private&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;sealed&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; class &amp;lt;&amp;gt;c__DisplayClass0_0&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;public&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;a&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;internal&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; void &amp;lt;M&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;b__0&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;        Console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;WriteLine&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;Format&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;a is {0}.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; x&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;));&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As we can see from the .NET implementation, we really just have a function with some data.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[A Begginer's Guide Scaling Out Relational Databases]]></title><description><![CDATA[Since a single database server can support a considerable load, it’s worth starting by saying that the need to scale out your database…]]></description><link>https://florintoader.me/2022-02-14-scaling-sql/</link><guid isPermaLink="false">https://florintoader.me/2022-02-14-scaling-sql/</guid><pubDate>Tue, 15 Feb 2022 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;Since a single database server can support a considerable load, it’s worth starting by saying that the need to scale out your database server means your business is doing several things right, so this is a good problem to have. While getting a machine with more processor cores, memory and disk space can alleviate your problems in the short term, at some point needing to distribute your database across multiple machines becomes unavoidable (before considering scaling out, however, consider the fact that most databases are &lt;strong&gt;read-heavy&lt;/strong&gt; meaning there are many more read operations than write operations and adding a caching layer can go a long way in improving performance — if this is not enough, secondary read replicas can be added to lessen the load in case of cache misses, but this also means there’s a small performance hit related to replication).&lt;/p&gt;
&lt;p&gt;There are several ways to set up database scale-out.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Vertical&lt;/strong&gt;. One approach to achieve scale-out is to have different tables from your schema reside on different machines. This is easy to implement in SQL Server because it is supported out of the box — distributed transactions across servers and hence referential integrity is also supported. This is also called &lt;em&gt;functional&lt;/em&gt; partitioning because avoiding distributed joins is usually recommended, which means the split will be done according to how tables are related to one another.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Horizontal&lt;/strong&gt;. Also called &lt;em&gt;sharding&lt;/em&gt;. With horizontal scale-out all nodes in the cluster have the same schema, but the table rows are being partitioned across the different nodes, which means a &lt;em&gt;partitioning strategy&lt;/em&gt; must be chosen for splitting the data. More on this later.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Mixed&lt;/strong&gt;. This strategy involves a combination of both previous approaches. In some cases our domain model is not easily shardable across a single dimension and it becomes convenient to use both vertical and horizontal partitioning.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Since fairly straight forward to implement vertical scale-out, this approach will very likely the first attempt at improving performance to be implemented, but more often than not it’s just a temporary solution because just like with scaling up there quickly comes a point of diminishing returns. It can however provide some temporary relief while implementing a sharding approach.&lt;/p&gt;
&lt;h3&gt;Sharding Strategies&lt;/h3&gt;
&lt;p&gt;Probably the most ubiquitous sharding strategy is to use a tenant key and one of the simplest sharding strategies is to have one database per user. That’s however not tenable if you have hundreds of thousands of users because it would mean one VM per user.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Range.&lt;/strong&gt; Sharding by range is probably the most simple way to implement horizontal partitioning and it means that each node in our cluster holds data associated with a certain range, for example data related to users. One drawback of that approach is that it doesn’t split data evenly.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Consistent hashing.&lt;/strong&gt; An approach that was developed to solve the problems associated with sharding by range is to use some form of hash as the key and there are several approaches to ensuring this repartition is uniform, hence the name &lt;em&gt;consistent&lt;/em&gt;. The problem with consistent caching is that while it does ensure you don’t have hotspots — the data might be spread evenly but &lt;em&gt;utilization&lt;/em&gt; (or reads) of that data isn’t. Consistent hashing also makes the rebalancing of shards quite difficult.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Using a keymap.&lt;/strong&gt; As the name suggests, this approach involves maintaining a list of keys-to-nodes mappings and it usually requires a different machine/database. Before querying data on a specific machine in the cluster, we first need to query the map, so this can add additional overhead.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We’ll mostly be looking at this approach from now on.&lt;/p&gt;
&lt;h3&gt;A Real World Example&lt;/h3&gt;
&lt;p&gt;Let’s imagine we’re building a social media application where users can create posts on their profile and comment on other users’ posts. The most natural strategy for splitting our data would be to do it by how that particular data is related to a user. The database would look similar to this.&lt;/p&gt;
&lt;img src=&quot;diag1.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;We can immediately see that we have a small predicament — a comment is tied to both a post of a certain user &lt;em&gt;and&lt;/em&gt; to the user making the comment. So how would we go about partitioning? While we can store the comments in each user’s shard, that’s a really bad way to do it because displaying comments on a single post involves querying multiple shards, so it is much better to tie the comment to the post and in turn to the user to which the post belongs to.&lt;/p&gt;
&lt;p&gt;So what happens if we want to create something like a &lt;em&gt;history&lt;/em&gt; page, a central log of the user’s actions which contains all the comments a user posted or the friends he or she added in chronological order? We could of course query all the shards and get that info, but if you’re a company like Facebook (and have millions of users) that’s not feasible. The alternative is to duplicate information in something like a &lt;em&gt;History&lt;/em&gt; table, so every time a user posts a comment we also add an entry there.&lt;/p&gt;
&lt;img src=&quot;diag2.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;Almost always sharding means we need to denormalize our data structure, so we’ll unavoidably have some data duplication.&lt;/p&gt;
&lt;p&gt;A typical case of duplication is catalog data (reference tables) which needs to be replicated across nodes. As an example, when users create their account, they can select a residence country and we would like to enforce referential integrity in the database via an FK constraint to a table containing a list of countries and if we want to avoid multi shard queries, this catalog must be on every node. Which means extra complexity.&lt;/p&gt;
&lt;h3&gt;Multi Shard Queries&lt;/h3&gt;
&lt;p&gt;Regardless of how you’re structuring your data, there’s probably no escaping multi shard queries. To explain why here’s what a typical feed from &lt;a href=&quot;&quot;&gt;500px&lt;/a&gt; looks like:&lt;/p&gt;
&lt;img src=&quot;500px.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;While we can show a user’s timeline by querying just one shard, we can’t do that for feeds, because individual users are most likely following a multitude of users residing on multiple shards. Social media sites implement a system called infinite scrolling whereas the user scrolls the page down, more content is loaded with multiple shards being hit.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;With applications like Facebook, users mostly tend to follow other people from their own country/city, so we can try grouping users based on location.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;An asynchronous job could update a feed table with post ids for each user. This is not instantaneous which is why if you’re using Facebook you might have noticed that there’s a delay between posting something and the post showing up in other people’s feeds. Also not all posts show up in your feed, only a small portion of them. This is both to make your feed more easily consumable and to save up resources.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Requests across shards can be batched.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What happens if the data for one user is too big for one node? In that case, our sharding key would be a combination of the &lt;em&gt;user-id&lt;/em&gt; and the &lt;em&gt;post-id&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Using A Mixed Approach&lt;/h3&gt;
&lt;p&gt;So far, projecting our data across the user dimension worked just fine, but what if we have a more complex system where this isn’t as straightforward? Let’s say we introduce one additional complication, that of social &lt;em&gt;groups&lt;/em&gt; where users can post.&lt;/p&gt;
&lt;img src=&quot;diag3.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;For groups, sharding by user id isn’t the optimal approach because again it would mean we would have to query multiple shards to display the messages in a group conversation. But since the group functionality tends to be somewhat isolated from the rest of the application, this lends itself well to a mixed or functional scale-out approach where the related tables can reside on their node(s). If we also need to implement sharding, we can do it independently along the &lt;em&gt;group_id&lt;/em&gt; dimension.&lt;/p&gt;
&lt;p&gt;The functional scale-out approach also works well in conjunction with microservices and DDD bounded contexts, but that’s a fairly extensive subject and something for another article.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[A Different Take On Handling Local State Using Hooks]]></title><description><![CDATA[When implementing simple React applications, Redux might cause significant overhead, and just using component state might be enough. There…]]></description><link>https://florintoader.me/2022-01-29-functional-state/</link><guid isPermaLink="false">https://florintoader.me/2022-01-29-functional-state/</guid><pubDate>Fri, 28 Jan 2022 21:39:37 GMT</pubDate><content:encoded>&lt;p&gt;When implementing simple React applications, Redux might cause significant overhead, and just using component state might be enough. There are however differences between class components and function components related to how hooks work, which we’ll look at next.&lt;/p&gt;
&lt;p&gt;With classes, component state is accessible via &lt;code&gt;this.state&lt;/code&gt;, and updating it (and triggering component rerendering) is done via &lt;code&gt;this.setState&lt;/code&gt;. In functional components, we use the &lt;code&gt;useState&lt;/code&gt; hook and instead of merging the object we’re passing in, the state is replaced. It can be used several times and the intention is to be used for each field we want to track — for example, if we have multiple inputs on the page, we can use the hook for the state of each one of them.&lt;/p&gt;
&lt;img src=&quot;img.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;On first look it seems there’s a simple solution - we can simply merge the state ourselves.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;loadSection1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;try&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;requestState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Loading&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchSection1Data&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;requestState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Loaded&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;catch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;requestState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Error&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  }) &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;loadSection2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;try&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      section2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;section1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;requestState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Loading&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchSection1Data&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      section2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;section2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;requestState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Loaded&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;catch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      section2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;section2&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;requestState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Error&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  })&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Where again &lt;code&gt;RequestState&lt;/code&gt; is:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;RequestState&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;Null&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;Loading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;Loaded&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;Error&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’ve started both actions at the same time. The first action finishes the fetch, updates the state, and triggers a render. Then the second action finishes, but because the function creates a closure around the update method, so state refers to the value when the action started. This means that the second action that finishes will overwrite the results of the other one.&lt;/p&gt;
&lt;p&gt;What we is a mutable way of tracking the state. Luckily, React provides a useRef hook that allows us to keep a reference to an object on a per-component basis. The typical use case for it is to store references to UI elements but it can be used to point to any object, so we can store our updated state in it whenever any of the responses return.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setComponentState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;any&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;stateRef&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;current&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;....&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;stateRef&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;current&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, necause we find this functionality useful, let’s create a custom hook.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;useRef&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;react&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useComponentState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;internalRef&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useRef&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;internalState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setInternalState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;internalRef&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;current&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setInternalState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;internalRef&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;current&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newState&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;internalState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, this can be used in our component the same way we would use the regular &lt;code&gt;useState&lt;/code&gt; hook:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;StatefulComponent&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useComponentState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// we ca bind the state here&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  )  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Calling &lt;code&gt;setState&lt;/code&gt; will trigger a component update.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Simplifying State Handling]]></title><description><![CDATA[In the previous example, we went over a global store app pattern that emulates Redux. The main advantage of this approach is familiarity…]]></description><link>https://florintoader.me/2022-01-17-simple-state/</link><guid isPermaLink="false">https://florintoader.me/2022-01-17-simple-state/</guid><pubDate>Sun, 16 Jan 2022 21:39:37 GMT</pubDate><content:encoded>&lt;p&gt;In the previous example, we went over a global store app pattern that emulates Redux. The main advantage of this approach is familiarity, meaning that developers can structure their projects using a similar folder/code structure. There is, however, an alternative approach popularized by  Svelte, which is less verbose. While this is a familiar approach, many developers feel that the single-store architectural approach leads to bad software patterns. Dan Abramov has famously likened asynchronicity and state mutations, yet having a global state object can easily lead to situations where existing functionality can rely on existing state (state that was fetched previously). Moreover, oftentimes users bookmark or refresh pages, which can lead to problems. Having a lot of stateful data can lead to brittle code because it relies on previously executed actions which might break the flow.&lt;/p&gt;
&lt;p&gt;(As a side note here, a lot of applications are clientside logic heavy and they do a lot of inner joins and computations where this information might be better sent to the server)&lt;/p&gt;
&lt;p&gt;One approach that client-side applications can borrow from server-side applications is to treat the URL as the current “state” and render solely based on that. That way, we ensure that the page always renders the same regardless of whether it was the result of client-side navigation or the user refreshing the page. An (imperfect) analogy that can be used here is that of pure functions - the result of the pure function always depends on the input parameters (in our case the URL), not some other application state. The analogy is imperfect because the page would of course render based on the server-side state. React’s functional components lend themselves well to this approach. We can use a simple example: imagine a page that displays products.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/products&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;By default, the page would display a list of products on sale or popular products.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/products?search=searchterm&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The following URL would show the user a search result list. Let’s consider the following scenario: a lot of sites allow the user to have a list of favorites. If a certain product is in the favorite list, the application shows an icon next to it. Instead of relying on a single global state object, we would have an individual store just for the product page that we would populate on URL navigation (which can be clientside or serverside).&lt;/p&gt;
&lt;p&gt;Our store uses the &lt;code&gt;useReducer&lt;/code&gt; hook for reasons explained in the following article. The aim is to create a personal organizer application that has two sections: notes and tasks. The note page and task page structure are similar, so we’ll present the code for notes as an example.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;useReducer&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;react&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Task&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;TaskStoreState&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Task&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;any&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useLoginStore&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;TaskStoreState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useReducer&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;reducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;addTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;ADD_TASK&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;removeTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;REMOVE_TASK&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;updateTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;UPDATE_TASK&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    actions&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;addTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;removeTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;updateTask&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;reducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;TaskStoreState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;switch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;ADD_TASKS&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; [&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;newid&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;REMOVE_TASK&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;filter&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;!==&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;UPDATE_TASK&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;map&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;!==&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;</content:encoded></item><item><title><![CDATA[What If We Wanted To Use Hooks Instead Of Redux?]]></title><description><![CDATA[While the rumors about Redux’s demise are most likely mostly exaggerated, there is no doubt we can achieve a lot of the functionality it…]]></description><link>https://florintoader.me/2022-01-12-hooks-architecture/</link><guid isPermaLink="false">https://florintoader.me/2022-01-12-hooks-architecture/</guid><pubDate>Tue, 11 Jan 2022 21:39:37 GMT</pubDate><content:encoded>&lt;p&gt;While the rumors about Redux’s demise are most likely mostly exaggerated, there is no doubt we can achieve a lot of the functionality it provides with hooks. Also, as a rule of thumb, we should avoid using as many external libraries as possible because chances are they could become deprecated in the future. While using the &lt;span class=&quot;code&quot;&gt;useReducer&lt;/span&gt; hook is relatively straightforward, React doesn’t provide a prescription on how to structure a relatively large application. To make matters worse, virtually every blog article on the internet recommends using a different approach.&lt;/p&gt;
&lt;p&gt;Let’s first take a look at the Redux data flow.&lt;/p&gt;
&lt;img src=&quot;redux2.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;First of all, it’s worth pointing out that the data flow is unidirectional. The user can trigger actions from the UI, which act on the application state via a &lt;em&gt;reducer&lt;/em&gt;, which in turn triggers rerendering of the UI. The is aim to replicate this flow using the built in React functionality.&lt;/p&gt;
&lt;p&gt;With hooks, React provides powerful features when writing functional components, and it’s not opinionated on how you use them. The problem is, choosing the right approach can be tricky because there are so many permutations. Developers moving from .NET WebAPI or Rails (which are very opinionated in how you name your controllers and routes) to NodeJS / Express (which imposes no restrictions on how to structure your code) will find this approach very familiar.&lt;/p&gt;
&lt;p&gt;Another relatively new addition to React is the Context API. If you’re not familiar with what it is, it’s a way for components to avoid having to pass down props through complex component trees — a technique known as &lt;em&gt;prop drilling&lt;/em&gt;. React’s rendering engine knows to react to changes in the context state, just as it is able to respond to changes in component state or prop changes.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;We could have different contexts per route with separate data stores for each of them.&lt;/li&gt;
&lt;li&gt;We could use a single context per application, and each route can keep its state in a property of the single app state object.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We’ll go with option number two because that’s what Redux does, and most developers are familiar with that approach. The aim is to create a personal organizer application that has two sections: notes and tasks. The note page and task page structure are similar, so we’ll present the code for notes as an example.&lt;/p&gt;
&lt;img src=&quot;pic2.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;Since we plan to lay the groundwork for a complex app, we’ll assume that this application has multiple &lt;em&gt;modules&lt;/em&gt;. Each module will have a &lt;em&gt;components&lt;/em&gt; folder, which contains the UI code, and a &lt;em&gt;store&lt;/em&gt; folder which contains the action creators and the reducer logic.&lt;/p&gt;
&lt;p&gt;The reducer created with the &lt;code&gt;useReducer&lt;/code&gt; hook works similar to a Redux reducer. It’s just a function that takes a &lt;em&gt;state&lt;/em&gt; object and an &lt;em&gt;action&lt;/em&gt; object, and based on that, it returns a new state object. One way of thinking about it is it’s a way of mutating state, but of course we’re not really mutate the existing state, but rather creating a new state object (immutability is one of the central tenets of functional programming).&lt;/p&gt;
&lt;p&gt;We’ll need to create reducer actions for:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Creating a new note.&lt;/li&gt;
&lt;li&gt;Removing an existing note.&lt;/li&gt;
&lt;li&gt;Updating an existing note.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;NotesState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Note&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;./types&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;ADD_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;REMOVE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;UPDATE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;./actions&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;v4&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;uuid&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; initialNotesState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesState&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; []&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;notesReducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;switch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;ADD_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;v4&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; [&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;REMOVE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;filter&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;!==&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;UPDATE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;map&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;              &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;              title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;              description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;note&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now that we have defined a reducer, we’ll want to create the equivalent of Redux’s action creators.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;react&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;./types&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;../../types&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; ADD_NOTE &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;ADD_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; REMOVE_NOTE &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;REMOVE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; UPDATE_NOTE &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;UPDATE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;addNote&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;ADD_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;removeNote&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;REMOVE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;updateNote&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;UPDATE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;description&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And finally, let’s have a look the &lt;em&gt;types.ts&lt;/em&gt; file.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;ADD_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;REMOVE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;UPDATE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;./actions&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Note&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesState&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Note&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;[]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;typeof&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; ADD_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;typeof&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; REMOVE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;typeof&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; UPDATE_NOTE&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;title&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Our application also has a &lt;em&gt;tasks&lt;/em&gt; section which has the same structure — actions, and a state reducer. Since the application uses a single data store, we need to combine both our reducers into a single one. We’ll create an &lt;em&gt;appReducer.ts&lt;/em&gt; file for this.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;TasksAction&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; initialAppState &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; initialTasksState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; initialNotesState&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;combinedReducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;notesReducer&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;NotesAction&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;tasksReducer&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;TasksAction&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s try to put it all together now. We need a way for the UI to be able to call our actions and to react to changes in the application state. We’ll use a global context that can be accessed from anywhere in the application via the useContext hook that will give the calling component access to the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The global state of the app.&lt;/li&gt;
&lt;li&gt;An execute method, which will allow it to trigger actions.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; React&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;useReducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;react&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;ChildrenProps&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;./modules/types&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; appReducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialAppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;./appReducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;ExecuteFunc&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;any&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Promise&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;void&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;void&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;type&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppContextType&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;execute&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;ExecuteFunc&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Promise&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;void&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// eslint-disable-next-line @typescript-eslint/no-explicit-any&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; AppContext &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; React&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;createContext&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;any&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppContextType&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;export&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;AppContextProvider&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;ChildrenProps&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useReducer&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;combinedReducer&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;initialAppState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;execute&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;AppState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Dispatch&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;Promise&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;void&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;|&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;void&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;try&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;dispatch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;catch&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;error&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// take appropriate action and report the error&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;alert&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;The application encountered an error.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;AppContext&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Provider&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;{ &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;execute&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;children&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;AppContext&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Provider&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  )&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’ll need to add the &lt;code&gt;AppContextProvider&lt;/code&gt; as the root component of the application. Then in a component, we can access the application state and the &lt;code&gt;execute&lt;/code&gt; method using the &lt;code&gt;useContext&lt;/code&gt; hook.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; execute &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useContext&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(AppContext)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;removeNoteClick&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;execute&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteActions&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;removeNote&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;noteId&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; notes &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// rendering the notes&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The source code can be found &lt;a href=&quot;https://github.com/toaderflorin/hooks-store&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[React Hooks Can Be Confusing]]></title><description><![CDATA[React’s development history is widely documented and was developed for internal use at Facebook, as it is the case with a lot of libraries…]]></description><link>https://florintoader.me/2021-11-18-hooks/</link><guid isPermaLink="false">https://florintoader.me/2021-11-18-hooks/</guid><pubDate>Thu, 18 Nov 2021 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;React’s development history is widely documented and was developed for internal use at Facebook, as it is the case with a lot of libraries, and for quite some time it was ES5 only — ES6 support of course followed, but the team quite quickly realized that if a component doesn’t need to maintain an internal state, there’s no need for it to be a class, and one of the major additions of v14.0 were stateless functional components. Not long after, the &lt;a href=&quot;https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0&quot;&gt;container / presentational pattern&lt;/a&gt; appeared, where the state changes would be handled in a wrapping class component, and the inner child component would handle the presentation part.&lt;/p&gt;
&lt;p&gt;The functional syntax became popular with quite a few developers — after all, languages like Elm are quite popular these days.&lt;/p&gt;
&lt;img src=&quot;hooks.jpg&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;The question then becomes: how does one keep the functional syntax and, at the same time, allows for the use of state in a component? The answer is, of course, hooks. Also, changing the syntax doesn’t mean the component state or lifecycle are going away.&lt;/p&gt;
&lt;p&gt;There’s a &lt;code&gt;useState&lt;/code&gt; hook, for example. There’s also a &lt;code&gt;useEffect&lt;/code&gt;, and we’ll look at both in a moment. Let’s consider a simple application that fetches some data from an API and then does something with it.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;App&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    isTasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;api&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;getTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useEffect&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;},&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// the empty dependency array indicates the effect runs on component mount &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #676E95; font-style: italic&quot;&gt;// and only once&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  [])&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;code&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;to&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;render&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  )&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The first thing that’s very apparent with hooks is we no longer have lifecycle methods like &lt;code&gt;componentDidMount&lt;/code&gt; or &lt;code&gt;componentWillReceiveProps&lt;/code&gt;, so we need to rely on a different mechanism — the  &lt;code&gt;useEffect&lt;/code&gt; hook fills that role now. If we want to react to the component being mounted, we can pass in an empty dependency array. If we want to emulate the &lt;code&gt;componentWillReceiveProps&lt;/code&gt; we can pass in the props as dependencies.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;App&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    isTasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;api&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;getTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useEffect&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;},&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  [&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;code&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;to&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;render&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  )&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It’s worth pointing out that the way &lt;code&gt;useState&lt;/code&gt; works with hooks is different that the way &lt;code&gt;useState&lt;/code&gt; works with class components.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;With class components, it merges the new state into the old state, via the JS spread syntax.&lt;/li&gt;
&lt;li&gt;With functional components, it simply replaces the state object.&lt;/li&gt;
&lt;li&gt;You can use &lt;code&gt;useState&lt;/code&gt; multiple times in functional components and have different instances of state.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;And extremely important, with functional components there is no &lt;code&gt;this.state&lt;/code&gt;. Also, functional components are &lt;em&gt;closures&lt;/em&gt;, which means they have their own lexical context, and so they capture the values of variables declared in the function when those functions were called. So in our case, when the response comes back from the server, the value of &lt;span class=&quot;code&quot;&gt;state` is the same as it was when the component was called. Typically, this wouldn’t be a problem, especially because you can use the &lt;span class=&quot;code&quot;&gt;useState&lt;/span&gt; hook multiple times, and you can have different disjointed pieces of state.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The main problem with this approach arises if you are trying to use one single view model object as state and merge new state prop values into it if you have to deal with concurrency.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The typical case in which this would happen is if you aren’t using a store manager like Redux, and use a &lt;a href=&quot;https://reactjs.org/docs/lifting-state-up.html&quot;&gt;lift state up&lt;/a&gt; approach. Typically, this would mean that you are usinng the root component, or the root component route as a state manager and you are using prop drilling and callbacks.&lt;/p&gt;
&lt;p&gt;So let’s illustrate the point. Let’s say that aside from tasks, we also want the user to be able to scribble down and manage notes, and we need to change the data we’re displaying when the currently logged in user changes.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;App&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notesLoading&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;api&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;getTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchNotes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;api&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;getNotes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useEffect&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;},&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  [&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Notes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  )&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;While not necessarily easy to spot, we now have a racing condition.&lt;/p&gt;
&lt;p&gt;We can change it like this.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;App&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;props&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setTasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;setNotes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;api&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;getTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;async&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchNotes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;await&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;api&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;getNotes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useEffect&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchNotes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;},&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  [&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasksLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;Notes&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notes&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;={&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;notesLoading&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;div&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  )&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Since we are no longer merging the old state into the big state object, we no longer have the racing condition. This is a perfectly valid approach for fixing the problem, but unfortunately, it means we have lost the hierarchical nature of the state object (so we can no longer use it as a view model) — remember that when we are lifting the state to the parent component, we would like the structure of the object to reflect the child component hierarchy.&lt;/p&gt;
&lt;p&gt;A fundamental difference between the old approach and the new one is the addition of the &lt;code&gt;useEffect&lt;/code&gt; hook, which is called after the functional component has rendered, making it behave like the &lt;code&gt;componentWillReceiveProps&lt;/code&gt; function. This approach is interesting because using this method to make API calls (and therefore changing the state) leads to rerendering. Reacting to state changes in the application is generally considered bad practice because it can also lead to complicated dependency chains, making the code hard to follow. Infinite loops are also a common problem in code written by newcomers.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;useEffect&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;fetchTasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;currentUser&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Calling the &lt;code&gt;fetchTask&lt;/code&gt; method like this causes an infinite loop because it sets the &lt;code&gt;isLoading&lt;/code&gt; field to &lt;code&gt;true&lt;/code&gt;, which triggers rerendering, which calls the effect again. In some cases, the dependency cycles might be more complicated: a parent component might trigger an effect in a child component, making the problem harder to diagnose. To make matters slightly worse is the fact that React’s strict mode triggers double rendering for debugging purposes (React tries to ensure your state changes are &lt;a href=&quot;https://stackoverflow.com/questions/1077412/what-is-an-idempotent-operation#:~:text=at%204%3A12-,12,as%20making%20a%20single%20request.&quot;&gt;idempotent&lt;/a&gt;, and don’t lead to infinite refreshing loops), which can make things extra confusing.&lt;/p&gt;
&lt;p&gt;To wrap up, while hooks are a welcome addition to React, the learning curve can be quite steep.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Reactivity And Immutability In React]]></title><description><![CDATA[Before getting into library-specific details, it’s worth starting with a definition of what constitutes reactivity. A typical example would…]]></description><link>https://florintoader.me/2021-11-05-immutability/</link><guid isPermaLink="false">https://florintoader.me/2021-11-05-immutability/</guid><pubDate>Fri, 05 Nov 2021 06:39:37 GMT</pubDate><content:encoded>&lt;p&gt;Before getting into library-specific details, it’s worth starting with a definition of what constitutes reactivity. A typical example would be an Excel spreadsheet: if a cell aggregates data from other cells, that cell instantly changes if we change a value in any of the aggregated cells. In reactive programming, if a variable A depends on B and C, a change in either B or C would also trigger a change in A. While there seems to be an ongoing debate whether React is truly reactive, there’s no doubt that the UI reacts to changes in the data model, even if parts of the model itself don’t react to other parts being changed, so from now on, we’ll consider this definition of reactivity.&lt;/p&gt;
&lt;p&gt;Since in most programming languages mutating an existing instance doesn’t notify other objects or the runtime of the change, a typical pattern is to use events or callbacks for this. As an example, Windows Presentation Foundation uses models that implement an interface called
&lt;span class=&quot;code&quot;&gt;INotifyPropertyChanged&lt;/span&gt; for data-binding and wraps class fields in getters and setters, and it’s the setter’s responsibility to fire change events. .NET provides a convenient base class object that implements the interface, so a typical observable view model would look like this:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;public &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;class&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;ObservableViewModel&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;ObservableObject&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;get&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;Field1&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;_field1&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;NotifyPropertChanged&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;field1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;set&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;_field1&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The WPF rendering system receives these events and then uses .NET’s reflection system to read the properties that are named like that. So if you are passing a different string in the notify event, it won’t work.&lt;/p&gt;
&lt;p&gt;VueJS does something similar, but it’s a little bit less transparent; it looks at the model the component was initialized with and then wraps the existing fields in getters and setters that also notify it. These wrappers aren’t directly visible to the user, which is why it is crucial to understand what the library does under the hood — adding a property to the model that wasn’t present when the component was initialized means that property isn’t observable.&lt;/p&gt;
&lt;p&gt;From the Vue docs:&lt;/p&gt;
&lt;img src=&quot;vue-reactivity.png&quot; class=&quot;img&quot; /&gt;
&lt;p&gt;Mutations play a central role when it comes to observability in these libraries, but React works a little bit differently because it is much more functional in nature. Rendering here is done by calling the setState method on a component, or the component receives new props from a parent. Of course, changing the whole thing is simple because react does a diff. But by using a little functional trick called &lt;em&gt;immutability&lt;/em&gt; in our code, we avoid even this diffing process.&lt;/p&gt;
&lt;p&gt;Let us use the customary task manager example and look at the following code:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskA &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;4b390f82-8b6f-4176-b28e-455ce9c24150&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;text&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;Send email to John.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskB &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;32557639-ca7a-4188-868a-2b5938d2bd01&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  text: &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;Play foosball.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskC &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskA&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;This should be false.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskA &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskB)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;console&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;log&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;This should be true.&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskA &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; taskC)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This of course is nothing new because JavaScript doesn’t check the values of the fields, it checks the instances and in the case of person A and B we have two different instances of an object with fields of equal value.&lt;/p&gt;
&lt;p&gt;Let’s say we now have a method that is called &lt;code&gt;removeLastName()&lt;/code&gt;. In the case of mutable languages we could write something like this:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;completeTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;completed&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But functional languages prohibit mutations, and even if JavaSript allows them, if we want to abide by functional principles, we can write it like this instead:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;completeTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    text&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;text&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This not only encourages the use of function composition for calculating complicated things, but it also ensures that checking for equality is easy and fast. Since we are never mutating an existing object, checking for value equality reduces to instance equality checking.&lt;/p&gt;
&lt;p&gt;Because of how change notification works in React, immutability is also encouraged because it allows easy diffing of object trees because the comparison algorythm doesn’t have to go drill down recursively, it can simply stop when two fields name the same differ in instance.&lt;/p&gt;
&lt;p&gt;Quite often, beginner React developers write code like this:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;updateTask&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; newText&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingTask&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;find&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;task&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;text&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;newText&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingTask&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;completed&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;lastName&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can do something else insted.&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;updateTask&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; text&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingTask&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;tasks&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;find&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;person&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;person&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingTask&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingTaskIndex&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;persons&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;indexOf&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingPerson&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;persons&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;[] &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;firstName&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;existingPerson&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;lastName&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;lastName&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;this.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      persons&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; [&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;persons&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    })&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  }&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This ensures updating works.&lt;/p&gt;
&lt;p&gt;Redux is in a some ways similar to the concept of &lt;a href=&quot;https://reactjs.org/docs/lifting-state-up.html&quot;&gt;lifting state up&lt;/a&gt;, but instead of lifting it up to a parent component, we push it to a single shared store. Our fully-fledged todos reducer would look like this:&lt;/p&gt;
&lt;pre class=&quot;shiki&quot; style=&quot;background-color: #292D3E&quot;&gt;&lt;code&gt;&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; ADD_TODO &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;ADD_TODO&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; TOGGLE_TODO &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;TOGGLE_TODO&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; CLEAR_TODOS &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&quot;color: #C3E88D&quot;&gt;CLEAR_TODOS&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;&amp;#39;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; todosReducer &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; []&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;ADD_TODO&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; [&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          text&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;text&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FF9CAC&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      ]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;TOGGLE_TODO&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #82AAFF&quot;&gt;map&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;todo&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #C792EA&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;todo&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;===&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;id&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;?&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;...&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;todo&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; { completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;todo&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;completed&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; } &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;          &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;todo&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      })&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;case&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #FFCB6B&quot;&gt;CLEAR_TODOS&lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt; []&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF; font-style: italic&quot;&gt;default&lt;/span&gt;&lt;span style=&quot;color: #F07178&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;      return &lt;/span&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;state&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #F07178&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #89DDFF&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;line&quot;&gt;&lt;span style=&quot;color: #A6ACCD&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instead of calling &lt;code&gt;setState()&lt;/code&gt;, we dispatch an action which is received by a reducer which returns a new value for the application state based on the existing state and the action. Just like setState, a reducer typically leaves the existing fields untouched and just overrides what we want to change but the result is a new instance. In case we don’t want to change anything, we should return state instead of &lt;code&gt;{...state}&lt;/code&gt;. Instance comparison still works.&lt;/p&gt;</content:encoded></item></channel></rss>