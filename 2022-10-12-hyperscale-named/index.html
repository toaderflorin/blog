<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><style data-href="/styles.a2284b55bd9bf414b52b.css" data-identity="gatsby-global-css">@font-face{font-family:gilroy;font-weight:400;src:url(/fonts/Gilroy-Regular.ttf)}@font-face{font-family:instrument;src:url(/fonts/Instrument.ttf)}@font-face{font-family:matter;src:url(/fonts/Matter-Regular.ttf)}@font-face{font-family:neuehaas;src:url(/fonts/NeueHaasDisplayRoman.ttf)}@font-face{font-family:lato;src:url(/fonts/Lato-Regular.ttf)}@font-face{font-family:avenir;src:url(/fonts/AvenirLTStd-Roman.otf)}@font-face{font-family:walsheim;src:url(/fonts/GT-Walsheim.otf)}@font-face{font-family:cisco;src:url(/fonts/CiscoSans.ttf)}@font-face{font-family:nexa;src:url(/fonts/Nexa-Book.ttf)}@font-face{font-family:tt;src:url(/fonts/TTHoves-Regular.ttf)}@font-face{font-family:poly;src:url(/fonts/poly.otf)}@font-face{font-family:suisse;src:url(/fonts/SuisseIntl-Regular.ttf)}@font-face{font-family:aktiv;src:url(/fonts/AktivGrotesk-Light.ttf)}@font-face{font-family:Matter;src:url(/fonts/Matter-Light.ttf)}@font-face{font-family:balto;src:url(/fonts/Balto-Book.ttf)}@font-face{font-family:mona;src:url(/fonts/MonaSans-Regular.ttf)}@font-face{font-family:roobert;src:url(/fonts/Roobert-Regular.ttf)}@font-face{font-family:balto;font-weight:700;src:url(/fonts/Balto-Bold.woff2)}@font-face{font-family:now;src:url(/fonts/HelveticaNow.otf)}@font-face{font-family:now;font-weight:700;src:url(/fonts/helvetica-bold.ttf)}@font-face{font-family:satoshi;font-weight:700;src:url(/fonts/Satoshi-Regular.otf)}@font-face{font-family:passenger;font-weight:700;src:url(/fonts/Passenger.otf)}@font-face{font-family:dmsans;src:url(/fonts/DMSans.ttf)}:root{--color-primary:#ff164c}*,:after,:before{box-sizing:border-box;margin:0}h1,h2,h3{font-weight:400;margin:0}html{margin:0;padding:0}pre.shiki{border-radius:5px;padding:15px}code,pre.shiki{font-size:13px}body{color:#111;font-family:now,serif;font-size:15px;line-height:1.45}h1{font-size:1.8rem}h3{font-size:1.3rem;line-height:2;margin-bottom:-1rem}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{margin:.7rem 0}a{color:var(--color-primary);text-decoration:none}.img{width:100%}.img-side{float:left;width:300px}ol,ul{margin:.7rem 0}.article-icon{float:left;height:64px;margin-right:8px;margin-top:6px;width:64px}.scroll-watcher{animation-range:exit;animation-timeline:view();animation:blur linear;animation-fill-mode:forwards;background:url(/static/img/coffee.jpg);inset:0;position:fixed;transform-origin:bottom center}.shiki{overflow:clip}@keyframes zoom{to{opacity:0}}@keyframes opacity{to{opacity:.5}}@keyframes blur{to{opacity:0;scale:1.3 1.3}}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.left-0{left:0}.right-0{right:0}.top-0{top:0}.z-0{z-index:0}.mx-auto{margin-left:auto;margin-right:auto}.my-5{margin-top:1.25rem}.mb-5,.my-5{margin-bottom:1.25rem}.mt-3{margin-top:.75rem}.mt-\[10px\]{margin-top:10px}.flex{display:flex}.hidden{display:none}.h-\[215px\]{height:215px}.h-\[3px\]{height:3px}.h-\[550px\]{height:550px}.h-\[82px\]{height:82px}.w-\[100\%\]{width:100%}.w-\[24px\]{width:24px}.w-\[5px\]{width:5px}.w-\[700px\]{width:700px}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.gap-1{gap:.25rem}.gap-3{gap:.75rem}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.bg-\[color\:var\(--color-primary\)\]{background-color:var(--color-primary)}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-cover{background-size:cover}.p-5{padding:1.25rem}.pb-\[20px\]{padding-bottom:20px}.pt-10{padding-top:2.5rem}.pt-4{padding-top:1rem}.text-right{text-align:right}.text-\[17px\]{font-size:17px}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-\[color\:var\(--color-primary\)\]{color:var(--color-primary)}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.text-slate-100{--tw-text-opacity:1;color:rgb(241 245 249/var(--tw-text-opacity))}.text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 0\.3\)\]{--tw-shadow:0 5px 30px -15px rgba(0,0,0,.3);--tw-shadow-colored:0 5px 30px -15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 1\)\]{--tw-shadow:0 5px 30px -15px #000;--tw-shadow-colored:0 5px 30px -15px var(--tw-shadow-color)}.shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 1\)\],.shadow-lg{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.duration-300{transition-duration:.3s}.hover\:text-black:hover{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.hover\:shadow-\[0_5px_30px_-15px_rgba\(0\2c 0\2c 0\2c 0\.7\)\]:hover{--tw-shadow:0 5px 30px -15px rgba(0,0,0,.7);--tw-shadow-colored:0 5px 30px -15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.span-1{grid-column:auto/span 1}.span-2{grid-column:auto/span 2}.span-3{grid-column:auto/span 3}@media only screen and (max-width:600px){.span-1,.span-2{grid-column:auto/span 1}}.cards{display:grid;gap:20px;grid-template-columns:1fr 1fr 1fr}.container{width:1000px}.margin{margin-top:550px}@media only screen and (max-width:600px){.cards{grid-template-columns:1fr;padding:10px}.cards,.container{width:auto}.margin{margin-top:300px}}.inner{-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);background-image:url(/img/me.jpeg);background-size:contain;border-radius:50%;color:#fff;height:120px;margin-bottom:10px;width:120px}.bar{align-items:center;background:hsla(0,0%,78%,.04);bottom:0;display:flex;flex-direction:column;left:0;padding:20px;position:absolute;top:0;width:64px;z-index:100}.hero{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);background:radial-gradient(at top left,rgba(47,49,58,.97),rgba(26,27,35,.97));border-radius:7px;height:550px;margin-top:30px;overflow:clip;width:1000px;@media only screen and (max-width:600px){height:300px;margin-left:15px;margin-right:15px;margin-top:15px;width:auto}}@media only screen and (max-width:600px){.header{padding-left:15px;width:auto}.post-container{padding:15px;width:auto}}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400&amp;display=swap"/><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=4376dbdae9096a24eda7625764953946" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4376dbdae9096a24eda7625764953946"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><header class="global-header"></header><main><div class="sticky top-0 left-0 right-0 text-white  h-[82px] shadow-lg mb-5" style="background:radial-gradient(at top center, rgba(47, 49, 58, 0.94), rgba(26, 27, 35, 0.94));font-size:16px"><div class="w-[700px] mx-auto flex items-center h-[82px] header"><img src="/img/me.jpeg" style="width:40px;border-radius:50%;margin-right:5px"/><a href="/" class="text-white">Florin Toader</a></div></div><title>Cloud Native Relational Databases Are Truly Game Changing</title><meta name="og:image:secure_url" content="https://florintoader.me/2024-01-08-ddd-bdd/cucumber.jpg"/><meta name="og:description" content="A common theme on this blog is performance optimizations and practical, real-world-oriented development. We talked about sharding, but probably most companies would want to do something other than roll out their custom sharding solution. A very simple way to improve performance is to implement a caching solution on your endpoints. But that still requires going to every endpoint and adding caching logic, thinking about cache eviction, etc.

"/><div class="h-[50px] bg-red-400"></div><article class="w-[700px] mx-auto pt-[10px] mb-[20px] mt-[150px] post-container" itemscope=""><header><h1 itemProp="headline">Cloud Native Relational Databases Are Truly Game Changing</h1><p><i>October 15, 2022</i></p></header><section itemProp="articleBody"><p>The word cloud native gets thrown around quite a bit, and depending on who you ask, you’ll get significantly different answers. My favorite way to define it is this: <em>Does your code run on promise as well as in the cloud, or only in the cloud? What would be a case where your code doesn’t run on premise, or only on premise? A case where that might not be the case is if you are using technologies like CosmosDB or Aurora.</em></p>
<p>The promise of the cloud is it makes data center operations easy—or easier than they would be if you’d have to manage your own data center, but you can also manage your own private cloud — yes, this involves a significant devops effort, but it can be done. However, there is a class of software that only runs</p>
<p>But there is also built in software that takes native advantage of the cloud infrastructure.</p>
<p>You could write your own sharding engine, but you probably don’t want to do that. Alternatively, you could technologies like Vitess or Citus and run your own k8s cluster, which is an entirely acceptable approach, albeit probably not the simplest approach. A truly cloud native approach is to use something like Azure Database Elastic tools. AD tools offer a sharding solution that’s built into the Azure cloud, the only caveat is it’s not transparent, meaning you need to use dedicated .NET code for data dependent routing. Azure provides a shard map manager which allows it to spread to load within the cluster. The shards are kept withing a special database in a dedicated node. A simpler alternative is to use an approach such as Aurora.</p>
<p>A common theme on this blog is performance optimizations and practical, real-world-oriented development. We talked about sharding, but probably most companies would want to do something other than roll out their custom sharding solution. A very simple way to improve performance is to implement a caching solution on your endpoints. But that still requires going to every endpoint and adding caching logic, thinking about cache eviction, etc.</p>
<p>Since most applications are significantly more read-heavy than write-heavy, we can use database replication and have multiple read-only replicas. The problem here is we run into CAP theorem limitations. Let’s assume that:</p>
<p>We are using sync replication: the more replica</p>
<p>What if we get rid of replication altogether?</p>
<h3>Azure Hyperscale is truly revolutionary</h3>
<p>Azure hyperscale separates the compute nodes (the bit that takes care of running complex queries) from the storage nodes. This means that we can scale up the</p>
<p>Hyperscale is truly cloud-native. Since the page servers are</p>
<img src="hyperscale.png" class="img" />
<p>Hyperscale allows two options for read replicas: high availability replicas and named replicas.</p>
<p>You can have up to four read replicas, and they work transparently. The application code doesn’t even need to know that they are there. Azure will take care of spreading calls to them.</p>
<p>If you want to further extend your read compute capacity, you can use named replicas.</p>
<h3>.NET Core Implementation</h3>
<p>If you are not using, you probably should.</p>
<pre class="shiki" style="background-color: #292D3E"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">class</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">GenericRepository</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">where</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">TEntity</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">class</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">internal</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">SchoolContext</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">context</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">internal</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">DbSet</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">dbSet</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">GenericRepository</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">SchoolContext</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">context</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #F78C6C">this</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">context </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> context</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #F78C6C">this</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">dbSet </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> context</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Set</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;();</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">virtual</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">IEnumerable</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Get</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #FFCB6B">Expression</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">Func</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">bool&gt;&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">filter</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">null,</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #FFCB6B">Func</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">IQueryable</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;,</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">IOrderedQueryable</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">orderBy</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">null,</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">string</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">includeProperties</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&quot;&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #FFCB6B">IQueryable</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">TEntity</span><span style="color: #89DDFF">&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">query</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> dbSet</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">filter </span><span style="color: #89DDFF">!=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">null)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            query </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> query</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Where</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">filter</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">foreach</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">var</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">includeProperty</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> includeProperties</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">Split</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">new</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">char[]</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">,</span><span style="color: #89DDFF">&#39;</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">},</span><span style="color: #A6ACCD"> StringSplitOptions</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">RemoveEmptyEntries</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            query </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> query</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Include</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">includeProperty</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">orderBy </span><span style="color: #89DDFF">!=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">null)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">orderBy</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">query</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">ToList</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">else</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> query</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">ToList</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">virtual</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">TEntity</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">GetByID</span><span style="color: #89DDFF">(object</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">id</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> dbSet</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Find</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">id</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">virtual</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Insert</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">TEntity</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">entity</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        dbSet</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Add</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entity</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">virtual</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Delete</span><span style="color: #89DDFF">(object</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">id</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #FFCB6B">TEntity</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">entityToDelete</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> dbSet</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Find</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">id</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #82AAFF">Delete</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entityToDelete</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">virtual</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Delete</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">TEntity</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">entityToDelete</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">context</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Entry</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entityToDelete</span><span style="color: #89DDFF">).</span><span style="color: #A6ACCD">State </span><span style="color: #89DDFF">==</span><span style="color: #A6ACCD"> EntityState</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">Detached</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            dbSet</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Attach</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entityToDelete</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #A6ACCD">        dbSet</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Remove</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entityToDelete</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">virtual</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Update</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">TEntity</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">entityToUpdate</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        dbSet</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Attach</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entityToUpdate</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">        context</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Entry</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">entityToUpdate</span><span style="color: #89DDFF">).</span><span style="color: #A6ACCD">State </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> EntityState</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">Modified</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
<p>A typical implementation would look like:</p>
<p>We can make use of the options functionality patter in C#.</p></section></article><div id="scroller" class="fixed h-[3px] left-0 top-0 bg-[color:var(--color-primary)]"></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022-10-12-hyperscale-named/";window.___webpackCompilationHash="c9f82561ea209a7b31f7";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-30f2bf2a1846f97f91ab.js"],"app":["/app-4dd56cb766cf2c35fd40.js"],"component---src-pages-404-js":["/component---src-pages-404-js-8450d0b5021920db5d71.js"],"component---src-pages-index-js":["/component---src-pages-index-js-7f21b7adf783b0d2224f.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-26890ade02ac40ec90e1.js"]};/*]]>*/</script><script src="/polyfill-30f2bf2a1846f97f91ab.js" nomodule=""></script><script src="/app-4dd56cb766cf2c35fd40.js" async=""></script><script src="/framework-d9aa49d9654a57a5d41b.js" async=""></script><script src="/webpack-runtime-f05b21f755d6a494c0ea.js" async=""></script></body></html>