<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><style data-href="/styles.0efa7660d3a0dc206572.css" data-identity="gatsby-global-css">@font-face{font-family:gilroy;font-weight:400;src:url(/fonts/Gilroy-Regular.ttf)}@font-face{font-family:instrument;src:url(/fonts/Instrument.ttf)}:root{--size-none:0;--size-100:1px;--size-200:2px;--size-300:3px;--size-400:5px;--size-500:8px;--size-600:12px;--size-700:17px;--size-800:23px;--color-primary:#ff164c}*,:after,:before{box-sizing:border-box;margin:0}h1,h2,h3{margin:0}h3{font-size:24px}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;margin:0;padding:0}body{color:#222;font-family:instrument,sans-serif,serif;font-size:11pt;line-height:1.65}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{margin:0 0 .5rem}a{color:var(--color-primary);text-decoration:none}.img{width:100%}.img-side{float:left;width:300px}.article-icon{float:left;height:64px;margin-right:8px;margin-top:6px;width:64px}code[class*=language-],pre[class*=language-]{background:#282c34;color:#abb2bf;direction:ltr;font-family:Menlo,Consolas,DejaVu Sans Mono,monospace;font-size:14px;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:2;tab-size:2;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:#3e4451;color:inherit;text-shadow:none}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.3em;white-space:normal}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}.token.cdata,.token.comment,.token.prolog{color:#5c6370}.token.doctype,.token.entity,.token.punctuation{color:#abb2bf}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:#d19a66}.token.keyword{color:#c678dd}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:#e06c75}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:#98c379}.token.function,.token.operator,.token.variable{color:#61afef}.token.url{color:#56b6c2}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:#abb2bf}.language-css .token.selector{color:#e06c75}.language-css .token.property{color:#abb2bf}.language-css .token.function,.language-css .token.url>.token.function{color:#56b6c2}.language-css .token.url>.token.string.url{color:#98c379}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:#c678dd}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#be5046}.language-json .token.operator{color:#abb2bf}.language-json .token.null.keyword{color:#d19a66}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:#abb2bf}.language-markdown .token.url>.token.content{color:#61afef}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:#56b6c2}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:#5c6370;font-style:italic}.language-markdown .token.code-snippet{color:#98c379}.language-markdown .token.bold .token.content{color:#d19a66}.language-markdown .token.italic .token.content{color:#c678dd}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:#e06c75}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:rgba(171,178,191,.15);text-shadow:none}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:#3a3f4b;border-radius:.3em;color:#828997;padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:#3e4451;color:#abb2bf}.line-highlight.line-highlight{background:rgba(153,187,255,.04)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:#3a3f4b;border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:#abb2bf;padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(153,187,255,.04)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:rgba(171,178,191,.15)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:#636d83}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e06c75}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#98c379}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#61afef}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#c678dd}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:#262931}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:#262931}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:#262931}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:#31363f}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:#abb2bf;stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:#abb2bf}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}#header-container{background-image:url(/img/bw.jpg);background-position:bottom;background-size:cover;grid-template-columns:1fr 1fr;position:fixed;z-index:-2}#header,#header-container{color:#fff;height:50vh;left:0;right:0;top:0}#header{align-items:center;border-radius:5px;display:flex;justify-content:center;padding:12px}#lower{display:grid;grid-template-columns:1fr 1fr}.centered{align-items:center;display:flex;justify-content:center}.post-list-item{box-sizing:content-box;cursor:pointer;margin-left:-25px;margin-right:-25px;padding:25px}.post-list-item:hover{box-shadow:0 0 40px 0 rgba(0,0,0,.1);transition:.25s}.post-read-more{color:#000;font-size:13px;font-weight:600;margin-top:5px}#main{box-shadow:0 0 20px 0 #000}#main,#main-inner{background-color:#fff}#main-inner{margin:0 auto;width:650px}#inner{align-items:center;display:flex;height:70px;margin:0 auto;padding:15px;width:800px}#first{background-color:#111;box-shadow:0 0 10px rgba(0,0,0,.8);color:#fff;height:70px;left:0;position:fixed;right:0;top:0}.content{margin:auto;width:700px}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400&amp;display=swap"/><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=4376dbdae9096a24eda7625764953946" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4376dbdae9096a24eda7625764953946"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4376dbdae9096a24eda7625764953946"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><header class="global-header"></header><main><div id="first"><div id="inner"><div>florin<b>toader</b></div></div></div><div class="content"><article class="blog-post" itemscope="" itemType="http://schema.org/Article" style="margin-top:150px"><header><h1 itemProp="headline">Modern Big Balls Of Mud</h1><p>April 26, 2022</p></header><section itemProp="articleBody"><p>Let’s consider several classes with public methods. Let’s also consider that they are  on the same hierarchical level and they can all see each other and call methods on one another. We can draw the following schematic indicating the dependency topology.</p>
<img src="ball.svg" class="img" />
<p>Let’s consider now what happens when component A needs a change in component D. We can obviously go ahead and make that change, but odds are that is going to have a  knock-on effect on other components that depend on it such as X and Y. Changes on these would potentially have more cascading effects and so on. So what we are left with is a very fragile and brittle structure, where changes are problematic. Because the existing structure is brittle, developers tend not to touch it, but instead add various hacks on top of it, which over time only makes matters worse.</p>
<p><em>In a big ball of mud architecture everything can see (and potentially depend) on everything else.</em></p>
<p>But direct dependencies aren’t the only culprit. Client-side apps are notorious for posing problems for maintainability, because of their event driven nature. Async events that trigger other portions of the application to redraw which in turn trigger other events (for example a <em>textChanged</em> event might trigger another API call that would trigger update event etc.). This was quite typical in the days of jQuery and it led many teams to just scrap their frontends altogether and rebuild the UI using newer libraries such as Knockout or Ember.</p>
<h3>A Glimpse Of Hope: MVVM To the Resque?</h3>
<p>Event based big balls of mud were such a problem for WinForms applications that Microsoft came up with a pattern called MVVM when they introduced out Windows Presentation Foundation. The fundamental idea here is there is a view-model that’s being updated (which acts as an abstraction layer), and not the UI itself. The WPF engine knows how to keep the view and the view model in sync smartly. This means that a lot of events such as a text being changed are triggered only as a result of a user action, not internal updates. KnockoutJS and Angular use a similar approach.</p>
<img src="MVVM.svg" class="img" />
<p>With MVVM, M refers to the domain model. This can be things such as users, records and so forth. The view refers to what’s visible on screen, which can be buttons, inputs etc. And finally, the view model is to an object that mimics what can be seen on screen — for an input in the view, there will usually be a text string in the view model, for a button there would be a command etc. Separation is the name of the game here: we don’t react directly to events in the UI, we introduce commands and data-binding, and the layout engine knows how to resolve them.</p>
<h3>React / Redux</h3>
<p>It was also issues with maintainability that led Facebook to develop some coding patterns (components with an unidirectional data flow, as opposed to bidirectional databinding), a virtual DOM with reconciliation and the Flux architectural pattern, that is also unidirectional.</p>
<p>Then came Redux and tightened things up a bit.</p>
<img src="redux.svg" class="img" />
<p>Normally, with React (as with most UI component frameworks) you have a UI hierarchy, which works as follows:</p>
<ul>
<li>You have a root compomponent that contains the navigtional structure.</li>
<li>There’s a router that maps page components to invididual routes.</li>
<li>For each route, there’s a root component which we call a “page”.</li>
<li>Each page is a component tree in and of itself.</li>
</ul>
<p>At one point in time, the standard way of building things in the React community (as pioneered by Dan Abramov) was to separate the rendering part and the “connected” part of each component in two separate classes. The rendering part was supposed to be a pure function.
And yes, this was consiered dogmatic, meaning that you would have to do it for each component, even if that component didn’t need to fire off Redux actions. If, for some reason, the component had to react to prop changes, an intermediat component would have to be sandwiched between the functional one and the container. The code would look something along these lines:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">myComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token comment">// render some code here</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// the connector</span></code></pre></div>
<p>Where as w/o it it’s:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">myComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token comment">// render some code here</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// the connector</span></code></pre></div>
<p>While there is little doubt that the dispatchers and the reducers tidy things up — this approach introduces some friction in updating state, so it is used sparingly, the global state can be problematic, and there’s quite a lot of debate what actually belongs to the application state and what belongs to component state.</p>
<p>Generally, we want code components to expose a stable interface and use information hiding. We also want them to be focused on one thing (the single responsibility principle). If code exeposes public properties, odds are other code will be using it, which leads to coupling. The same applies to UI components: they should just do one thing (display certain details for a certain domain object), show a form etc. So arguably, if we show a bunch of form fields, we can most likely keep the state in the component, or use some kind of form library that handles state itself, not move it to the global app state. If we build a date-picker control, it can keep internal props inside the component state etc.</p>
<p><em>Keeping state in the global store, mutating it and accessing it should be a concious and well thought out decision.</em></p>
<p>Just as keeping everything in the global state should be avoided, so should reacting to prop changes in components and firing off other Redux actionss. Let’s look at why:</p>
<ul>
<li>Several child components can be connected to the Redux state, and this state is being passed to date as props in the connector. There is usually a lot of shared state (like catalog data etc.).</li>
<li>Upon receiving prop change notifications, they can in turn perform actions that trigger API calls, state updates in Redux and other prop change notifcations. Many times, they originate from child components deep inside the component tree. These components might decide they are missing some data, or data is out of date, and trigger a refresh in the sections of the app that depend on this data.</li>
<li>Over time, this can lead to a lot of actions being fired off and a lot of updates being triggered, which makes the whole thing very hard to maintain.</li>
</ul>
<p>Let’s look at what can be done to mitigate these problems.</p>
<ul>
<li>Don’t connect each child component to Redux, only do that from root components (which would usually be one per route).</li>
<li>Isolate the sections in the Redux store per module / route.</li>
</ul>
<h3>A Quick Note On Microservices</h3>
<p>Microservices are often touted as the antidote to problems associated with monolithic apps, such as the ubiquitous big ball of mud architectures that arise, but you can have a big ball of mud microservice architecture as well.</p>
<p>Normally, the prescribed way to build web APIs is to use a tiered approach:</p>
<p>However, over time, at the service level you might get something like:</p>
<p><em>Everything talks to everything else is a recipe for disaster.</em></p>
<p>Even if we get something like</p></section></article></div></main><footer style="background-color:#eee">Blaakjskas</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022-04-30-big-ball-of-mud/";window.___webpackCompilationHash="579701483d0773630952";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-30f2bf2a1846f97f91ab.js"],"app":["/app-b6ea4da22fe8df02d68e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4da56516dd4ffcf4ac5d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-2943ff216d3bda5ffaf2.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-f8d416ec47ce73507d68.js"]};/*]]>*/</script><script src="/polyfill-30f2bf2a1846f97f91ab.js" nomodule=""></script><script src="/app-b6ea4da22fe8df02d68e.js" async=""></script><script src="/framework-d9aa49d9654a57a5d41b.js" async=""></script><script src="/webpack-runtime-8f3d7f193a34cf8f150c.js" async=""></script></body></html>