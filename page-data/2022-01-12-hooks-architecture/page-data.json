{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2022-01-12-hooks-architecture/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"08d08b2f-743f-575e-a800-fa507f9ccf76","excerpt":"While the rumors about Redux’s demise are most likely mostly exaggerated, there is no doubt we can achieve a lot of the functionality it provides with hooks…","html":"<p>While the rumors about Redux’s demise are most likely mostly exaggerated, there is no doubt we can achieve a lot of the functionality it provides with hooks. Also, as a rule of thumb, we should avoid using as many external libraries as possible because chances are they could become deprecated in the future. While using the <span class=\"code\">useReducer</span> hook is relatively straightforward, React doesn’t provide a prescription on how to structure a relatively large application. To make matters worse, virtually every blog article on the internet recommends using a different approach.</p>\n<p>Let’s first take a look at the Redux data flow.</p>\n<img src=\"arch.png\" class=\"img\" />\n<p>First of all, it’s worth pointing out that the data flow is unidirectional. The user can trigger actions from the UI, which act on the application state via a <em>reducer</em>, which in turn triggers rerendering of the UI. The is aim to replicate this flow using the built in React functionality.</p>\n<p>With hooks, React provides powerful features when writing functional components, and it’s not opinionated on how you use them. The problem is, choosing the right approach can be tricky because there are so many permutations. Developers moving from .NET WebAPI or Rails (which are very opinionated in how you name your controllers and routes) to NodeJS / Express (which imposes no restrictions on how to structure your code) will find this approach very familiar.</p>\n<p>Another relatively new addition to React is the Context API. If you’re not familiar with what it is, it’s a way for components to avoid having to pass down props through complex component trees — a technique known as <em>prop drilling</em>. React’s rendering engine knows to react to changes in the context state, just as it is able to respond to changes in component state or prop changes.</p>\n<ol>\n<li>We could have different contexts per route with separate data stores for each of them.</li>\n<li>We could use a single context per application, and each route can keep its state in a property of the single app state object.</li>\n</ol>\n<p>We’ll go with option number two because that’s what Redux does, and most developers are familiar with that approach. The aim is to create a personal organizer application that has two sections: notes and tasks. The note page and task page structure are similar, so we’ll present the code for notes as an example.</p>\n<img src=\"pic2.png\" class=\"img\" />\n<p>Since we plan to lay the groundwork for a complex app, we’ll assume that this application has multiple <em>modules</em>. Each module will have a <em>components</em> folder, which contains the UI code, and a <em>store</em> folder which contains the action creators and the reducer logic.</p>\n<p>The reducer created with the <code class=\"language-text\">useReducer</code> hook works similar to a Redux reducer. It’s just a function that takes a <em>state</em> object and an <em>action</em> object, and based on that, it returns a new state object. One way of thinking about it is it’s a way of mutating state, but of course we’re not really mutate the existing state, but rather creating a new state object (immutability is one of the central tenets of functional programming).</p>\n<p>We’ll need to create reducer actions for:</p>\n<ol>\n<li>Creating a new note.</li>\n<li>Removing an existing note.</li>\n<li>Updating an existing note.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NotesState<span class=\"token punctuation\">,</span> NotesAction<span class=\"token punctuation\">,</span> Note <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./types'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">ADD_NOTE</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">REMOVE_NOTE</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">UPDATE_NOTE</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./actions'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> v4 <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'uuid'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> initialNotesState<span class=\"token operator\">:</span> NotesState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  notes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">notesReducer</span><span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> NotesState<span class=\"token punctuation\">,</span> action<span class=\"token operator\">:</span> NotesAction<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">ADD_NOTE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> note <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        id<span class=\"token operator\">:</span> <span class=\"token function\">v4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        title<span class=\"token operator\">:</span> action<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n        description<span class=\"token operator\">:</span> action<span class=\"token punctuation\">.</span>description\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        notes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span> note<span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">REMOVE_NOTE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        notes<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>note<span class=\"token operator\">:</span> Note<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> note<span class=\"token punctuation\">.</span>id <span class=\"token operator\">!==</span> action<span class=\"token punctuation\">.</span>noteId<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">UPDATE_NOTE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        notes<span class=\"token operator\">:</span> state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>note<span class=\"token operator\">:</span> Note<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>note<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> action<span class=\"token punctuation\">.</span>noteId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token operator\">...</span>note<span class=\"token punctuation\">,</span>\n              title<span class=\"token operator\">:</span> action<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n              description<span class=\"token operator\">:</span> action<span class=\"token punctuation\">.</span>description\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> note\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> state\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now that we have defined a reducer, we’ll want to create the equivalent of Redux’s action creators.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Dispatch <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NotesAction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./types'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AppState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../types'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">ADD_NOTE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'ADD_NOTE'</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">REMOVE_NOTE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'REMOVE_NOTE'</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">UPDATE_NOTE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'UPDATE_NOTE'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">addNote</span><span class=\"token punctuation\">(</span>title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> AppState<span class=\"token punctuation\">,</span> dispatch<span class=\"token operator\">:</span> Dispatch<span class=\"token operator\">&lt;</span>NotesAction<span class=\"token operator\">></span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token constant\">ADD_NOTE</span><span class=\"token punctuation\">,</span>\n      title<span class=\"token punctuation\">,</span>\n      description\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">removeNote</span><span class=\"token punctuation\">(</span>noteId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> AppState<span class=\"token punctuation\">,</span> dispatch<span class=\"token operator\">:</span> Dispatch<span class=\"token operator\">&lt;</span>NotesAction<span class=\"token operator\">></span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token constant\">REMOVE_NOTE</span><span class=\"token punctuation\">,</span>\n      noteId\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">updateNote</span><span class=\"token punctuation\">(</span>noteId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> AppState<span class=\"token punctuation\">,</span> dispatch<span class=\"token operator\">:</span> Dispatch<span class=\"token operator\">&lt;</span>NotesAction<span class=\"token operator\">></span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token constant\">UPDATE_NOTE</span><span class=\"token punctuation\">,</span>\n      noteId<span class=\"token punctuation\">,</span>\n      title<span class=\"token punctuation\">,</span>\n      description\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And finally, let’s have a look the <em>types.ts</em> file.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">ADD_NOTE</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">REMOVE_NOTE</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">UPDATE_NOTE</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./actions'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">Note</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">NotesState</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  notes<span class=\"token operator\">:</span> Note<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">NotesAction</span> <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">ADD_NOTE</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">REMOVE_NOTE</span><span class=\"token punctuation\">,</span> noteId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">UPDATE_NOTE</span><span class=\"token punctuation\">,</span> noteId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Our application also has a <em>tasks</em> section which has the same structure — actions, and a state reducer. Since the application uses a single data store, we need to combine both our reducers into a single one. We’ll create an <em>appReducer.ts</em> file for this.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Action</span> <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> NotesAction\n  <span class=\"token operator\">|</span> TasksAction\n\n<span class=\"token keyword\">const</span> initialAppState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  tasks<span class=\"token operator\">:</span> initialTasksState<span class=\"token punctuation\">,</span>\n  notes<span class=\"token operator\">:</span> initialNotesState\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">combinedReducer</span><span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> AppState<span class=\"token punctuation\">,</span> action<span class=\"token operator\">:</span> Action<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    notes<span class=\"token operator\">:</span> <span class=\"token function\">notesReducer</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span> action <span class=\"token keyword\">as</span> NotesAction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tasks<span class=\"token operator\">:</span> <span class=\"token function\">tasksReducer</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>tasks<span class=\"token punctuation\">,</span> action <span class=\"token keyword\">as</span> TasksAction<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Let’s try to put it all together now. We need a way for the UI to be able to call our actions and to react to changes in the application state. We’ll use a global context that can be accessed from anywhere in the application via the useContext hook that will give the calling component access to the following:</p>\n<ol>\n<li>The global state of the app.</li>\n<li>An execute method, which will allow it to trigger actions.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useReducer<span class=\"token punctuation\">,</span> Dispatch <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AppState<span class=\"token punctuation\">,</span> ChildrenProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/types'</span>\n<span class=\"token keyword\">import</span> appReducer<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> initialAppState<span class=\"token punctuation\">,</span> Action <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./appReducer'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">ExecuteFunc</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> AppState<span class=\"token punctuation\">,</span> dispatch<span class=\"token operator\">:</span> Dispatch<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span> \n  <span class=\"token operator\">=></span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">AppContextType</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  state<span class=\"token operator\">:</span> AppState\n  <span class=\"token function-variable function\">execute</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>action<span class=\"token operator\">:</span> ExecuteFunc<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// eslint-disable-next-line @typescript-eslint/no-explicit-any</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> AppContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">any</span> <span class=\"token keyword\">as</span> AppContextType<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">AppContextProvider</span><span class=\"token punctuation\">(</span>props<span class=\"token operator\">:</span> ChildrenProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span>combinedReducer<span class=\"token punctuation\">,</span> initialAppState<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">action</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>state<span class=\"token operator\">:</span> AppState<span class=\"token punctuation\">,</span> dispatch<span class=\"token operator\">:</span> Dispatch<span class=\"token operator\">&lt;</span>Action<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> \n    <span class=\"token operator\">=></span><span class=\"token punctuation\">;</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> <span class=\"token function\">action</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// take appropriate action and report the error</span>\n      <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'The application encountered an error.'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>AppContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">,</span> execute <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>AppContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We’ll need to add the <code class=\"language-text\">AppContextProvider</code> as the root component of the application. Then in a component, we can access the application state and the <code class=\"language-text\">execute</code> method using the <code class=\"language-text\">useContext</code> hook.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">,</span> execute <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>AppContext<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">removeNoteClick</span><span class=\"token punctuation\">(</span>noteId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>noteActions<span class=\"token punctuation\">.</span><span class=\"token function\">removeNote</span><span class=\"token punctuation\">(</span>noteId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> notes <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">.</span>notes\n\n<span class=\"token comment\">// rendering the notes</span></code></pre></div>\n<p>The source code can be found <a href=\"https://github.com/toaderflorin/hooks-store\">here</a>.</p>","frontmatter":{"title":"What If We Wanted To Use Hooks Instead Of Redux?","date":"January 11, 2022","description":" While the rumors about Redux's demise are most likely mostly exaggerated, that there is no doubt we can achieve a lot of the functionality it provides with hooks. Also, as a rule of thumb, we should avoid using as many external libraries as possible because chances are they could become deprecated in the future. While using the useReducer hook is relatively straightforward, React doesn't provide a prescription on how to structure a relatively large application. "}},"previous":{"fields":{"slug":"/2022-04-09-cap/"},"frontmatter":{"title":"The CAP Theorem Hugely Oversimplifies Things"}},"next":{"fields":{"slug":"/2022-04-09-cap/"},"frontmatter":{"title":"The CAP Theorem Hugely Oversimplifies Things"}}},"pageContext":{"id":"08d08b2f-743f-575e-a800-fa507f9ccf76"}},
    "staticQueryHashes": []}