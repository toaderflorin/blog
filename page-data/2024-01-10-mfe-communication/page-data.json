{"componentChunkName":"component---src-templates-blog-post-js","path":"/2024-01-10-mfe-communication/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"ba8793e1-66ee-5c12-bbcb-08af73fd9bdb","excerpt":"When using micro-frontends, with technologies like SingleSPA or module federation, something that normally comes to mind is how does one MFE communicate with…","html":"<p>When using micro-frontends, with technologies like SingleSPA or module federation, something that normally comes to mind is how does one MFE communicate with another. There are several reasons why this might be the case.</p>\n<p>Flows that span multiple MFEs, for example, triggering a popup or notification in another micro-frontend.</p>\n<img src=\"frames.png\" class=\"img\" />\n<p>Sharing some piece of state or session.</p>\n<p>Triggering a page refresh.</p>\n<h2>Lifting State Up /</h2>\n<p>A common pattern with React components is taking the component hierarchy, and moving the state in the current properties one level higher.\nLet’s assume have a component and we are displaying it in a list.</p>\n<p>Initially, it’s the comp.</p>\n<p>We can do one call</p>\n<h2>Local Storage / Session Storage</h2>\n<p>If we lift state all the way to the root component, we can sync it to local storage.</p>\n<pre class=\"shiki\" style=\"background-color: #292D3E\"><code><span class=\"line\"><span style=\"color: #C792EA\">const</span><span style=\"color: #A6ACCD\"> mfeState </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #A6ACCD\"> JSON</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">parse</span><span style=\"color: #A6ACCD\">(localStorage</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">getItem</span><span style=\"color: #A6ACCD\">(MFE_NAME))</span></span></code></pre>\n<p>You will have one entry per MFE, and it will be hierarchical, just like Redux state.</p>\n<p>Make sure you are familiar with <a href=\"https://redux.js.org/usage/structuring-reducers/immutable-update-patterns\">immutable update patterns</a>.</p>\n<h2>The URL As State</h2>\n<p>Lifting the state even higher means putting it in the URL. In fact, doing a local redirect is the best way to trigger re-rendering across MFEs.\nA simple approach would be this:</p>\n<pre class=\"shiki-unknown\"><code>/state=%7B%22firstName%22%3A%22Florin%22%2C%22lastName%22%3A%22Toader%22%7D</code></pre>\n<p>There are some security considerations with keeping the entire state in the URL. An alternative is to keep just IDs. For example:</p>\n<h2>Window Level Events</h2>\n<p>One microfrontend can communicate with another simply by triggering an event on the window.</p>\n<pre class=\"shiki\" style=\"background-color: #292D3E\"><code><span class=\"line\"><span style=\"color: #C792EA\">const</span><span style=\"color: #A6ACCD\"> catFound </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">new</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #82AAFF\">CustomEvent</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">animalfound</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">{</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">  </span><span style=\"color: #F07178\">detail</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">{</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">    </span><span style=\"color: #F07178\">name</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">cat</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">  </span><span style=\"color: #89DDFF\">},</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">}</span><span style=\"color: #A6ACCD\">)</span><span style=\"color: #89DDFF\">;</span></span></code></pre>\n<p>This can be easily captured:</p>\n<pre class=\"shiki\" style=\"background-color: #292D3E\"><code><span class=\"line\"><span style=\"color: #C792EA\">const</span><span style=\"color: #A6ACCD\"> catFound </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">new</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #82AAFF\">CustomEvent</span><span style=\"color: #A6ACCD\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">animalfound</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">{</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">  </span><span style=\"color: #F07178\">detail</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">{</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">    </span><span style=\"color: #F07178\">name</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #A6ACCD\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">cat</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #A6ACCD\">  </span><span style=\"color: #89DDFF\">},</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">}</span><span style=\"color: #A6ACCD\">)</span><span style=\"color: #89DDFF\">;</span></span></code></pre>","frontmatter":{"title":"Micro-Frontend Communication Patterns","date":"January 13, 2024","description":"Architects are the creative visionaries who conceptualize and design the overall form, function, and aesthetics of buildings. They consider factors like aesthetics, functionality, sustainability, and user experience to create spaces that are both aesthetically pleasing and functionally effective. Architects possess a deep understanding of architectural history, design principles, and building codes. They translate client requirements into detailed drawings and specifications that guide the construction process.  ","image":"cucumber.jpg","cells":null}},"previous":{"fields":{"slug":"/2024-01-10-styling/"},"frontmatter":{"title":"Is Radix UI More Easy To Customize Than MUI?"}},"next":{"fields":{"slug":"/2024-01-10-styling/"},"frontmatter":{"title":"Is Radix UI More Easy To Customize Than MUI?"}}},"pageContext":{"id":"ba8793e1-66ee-5c12-bbcb-08af73fd9bdb"}},"staticQueryHashes":[]}